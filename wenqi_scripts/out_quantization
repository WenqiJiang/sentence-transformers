Loaded vector shape:  (579640, 384)
Shape: DB (500000, 384) 	 Query (1000, 384) 	 Training (50000, 384)
Max absolute value in the database:  0.31768098
99% absolute value in the database:  0.11948662996292114
Building Flat index for ground truth computation...
add 0:100000, 0.116 s add 100000:200000, 0.223 s add 200000:300000, 0.410 s add 300000:400000, 0.686 s add 400000:500000, 0.795 s Searching for ground truth...

Out of 1000 queries, 58 have duplicated nearest neighbor (tied distance)
i = 0	fp32 square sum: 1.0000003576278687	fp16 square sum: 0.9999710321426392
i = 1	fp32 square sum: 0.9999998211860657	fp16 square sum: 1.0000076293945312
i = 2	fp32 square sum: 0.9999995231628418	fp16 square sum: 1.0000135898590088
i = 3	fp32 square sum: 1.0000001192092896	fp16 square sum: 0.9999072551727295
i = 4	fp32 square sum: 1.0000003576278687	fp16 square sum: 1.000014066696167
i = 5	fp32 square sum: 1.000000238418579	fp16 square sum: 1.0000600814819336
i = 6	fp32 square sum: 1.0000001192092896	fp16 square sum: 0.9999908804893494
i = 7	fp32 square sum: 0.9999995231628418	fp16 square sum: 0.9999405145645142
i = 8	fp32 square sum: 1.0000001192092896	fp16 square sum: 0.9999399781227112
i = 9	fp32 square sum: 0.9999998211860657	fp16 square sum: 0.9999574422836304
Building index using floating point 16...
add 0:100000, 0.111 s add 100000:200000, 0.217 s add 200000:300000, 0.404 s add 300000:400000, 0.681 s add 400000:500000, 0.790 s Searching...
R@1 = 0.9490
R@10 = 0.9680
R@100 = 0.9970
Experiment int8... scale factor = 0.3176809847354889
Before quantization: 
 [-1.49867618e-02 -9.68345348e-03 -5.79111241e-02 -3.40401605e-02
 -5.84010631e-02  1.54728433e-02 -3.74758942e-03  8.23296420e-03
 -3.01494971e-02  3.08102649e-02  1.13890767e-01 -1.14366421e-02
 -8.46892875e-03  7.74566829e-03  3.95780094e-02  5.17672338e-02
 -2.68540829e-02  4.80111353e-02 -4.65955725e-03  3.34247504e-03
 -2.29886174e-02  1.94406020e-04  6.12896234e-02  1.89975984e-02
 -3.93570587e-02 -3.40035483e-02  5.29002696e-02 -6.73171431e-02
 -3.18305343e-02 -6.47372678e-02 -1.28957117e-02 -7.79697532e-03
 -6.84998110e-02  4.49257270e-02 -6.86620697e-02  4.43314910e-02
  5.74522875e-02 -3.08865830e-02 -2.62973495e-02  3.40816341e-02
 -6.78526089e-02 -6.41803890e-02  3.15261297e-02 -2.51773596e-02
 -9.34352726e-03 -1.55171724e-02  3.13819274e-02 -7.63133019e-02
  6.93198517e-02  6.35677762e-03  1.47650717e-03 -2.98002828e-02
  3.32436226e-02  1.20005116e-03 -9.14921984e-03 -6.41457438e-02
  3.25135961e-02 -3.86229344e-02 -2.61718389e-02  1.49117317e-02
  7.21704364e-02  2.35404242e-02 -2.27502938e-02  3.32574919e-02
 -4.88067493e-02 -5.55564277e-02 -1.45545555e-02  5.07149147e-03
 -3.56880506e-03 -2.36863233e-02  1.40741933e-02 -3.48075340e-03
 -4.31204736e-02  2.18455698e-02  4.06909883e-02 -4.77637202e-02
  8.16162080e-02  4.87731695e-02  4.01032642e-02  1.57765877e-02
 -4.08191793e-02  3.03414892e-02  3.87875251e-02 -4.71578874e-02
  1.88364442e-02  2.05781907e-02 -3.56025845e-02  4.92872447e-02
 -4.04932089e-02 -2.56460179e-02  9.42029618e-03  4.22992446e-02
 -1.11963868e-01 -1.08125117e-02 -6.35822639e-02  3.87455001e-02
 -2.47221589e-02  3.78200226e-02 -6.44943863e-02  6.30875379e-02
 -7.12282583e-02  7.53201842e-02  8.37952569e-02  3.81772481e-02
 -6.15315251e-02 -8.99483860e-02  4.84602414e-02 -2.01212522e-02
  5.39325178e-02 -9.89652332e-03  3.09501532e-02 -8.99807066e-02
 -6.74129277e-02  4.07188386e-03  1.38107147e-02  6.58543482e-02
  2.16003526e-02 -4.01584692e-02 -9.61588919e-02 -6.52997345e-02
 -1.19673759e-02  1.56386346e-02  7.09095821e-02  3.20403911e-02
 -2.00403128e-02 -6.43938407e-02 -9.91705731e-02  2.62832570e-34
  5.33027761e-02  2.87559871e-02  5.68117984e-02  3.57985310e-02
  5.17026037e-02 -1.00081079e-02  8.73631053e-03  3.53132039e-02
  2.50439458e-02  9.54495557e-03 -2.23834850e-02 -2.68531516e-02
  6.06561787e-02 -1.91564728e-02  2.37346515e-02 -7.54912421e-02
 -4.46815826e-02 -5.08830957e-02 -2.28309687e-02 -8.40491522e-03
  9.68801826e-02  3.63240428e-02  2.32038852e-02 -4.30141464e-02
 -4.80103493e-02  7.30274841e-02  1.53448552e-01  2.32242756e-02
  1.04601488e-01  2.84230933e-02 -3.12963352e-02 -5.08695543e-02
 -5.30726090e-02 -9.35416222e-02  1.08407155e-01 -5.30931279e-02
 -1.41807878e-02  2.00267918e-02  6.61519729e-03  1.56937242e-02
  2.58342959e-02 -2.64351722e-02  8.31351876e-02  2.05967063e-03
 -3.99919711e-02  5.59228621e-02  1.51585996e-01 -1.06778312e-02
 -2.06448305e-02 -3.34620029e-02 -1.24203831e-01  5.15222922e-02
 -3.28843878e-03 -3.30695100e-02  5.16825318e-02 -3.40045244e-02
  6.23184480e-02 -2.29074862e-02 -5.42399734e-02 -8.67629796e-03
 -3.97358090e-02  5.86575903e-02 -3.74881066e-02  5.10992892e-02
 -6.59760162e-02 -7.75630474e-02  2.23245677e-02 -8.87607560e-02
  9.07822847e-02 -3.51750888e-02 -7.51072094e-02  3.44051160e-02
 -6.14057630e-02 -8.57327692e-03 -2.24762894e-02  2.09367536e-02
 -3.09693497e-02  1.41246675e-03 -6.83588721e-03 -5.43593615e-02
  2.11986210e-02 -2.05597077e-02  4.65770438e-02  4.59764935e-02
 -6.99426904e-02 -1.52349640e-02 -1.04732588e-02 -7.49177486e-02
 -2.55625006e-02  5.47486879e-02 -2.50392798e-02  2.31649559e-02
  5.35149723e-02  3.50459442e-02  4.20869142e-02 -2.63932130e-33
  3.37502584e-02  1.73416326e-03 -6.24770448e-02 -1.58950407e-02
  1.22457102e-01  1.57097261e-02  8.38483963e-03  6.33168370e-02
 -1.66476108e-02 -4.66118678e-02  7.96821415e-02 -1.30651994e-02
 -5.72722498e-03 -5.54403523e-03  1.23275213e-01  3.43351103e-02
  7.27453455e-03  7.61426380e-03 -4.59552035e-02 -2.19059619e-03
  1.11198932e-01  9.65301916e-02  3.89098674e-02 -6.07600659e-02
 -1.44319925e-02 -2.37527546e-02  1.40748173e-01  1.01559199e-02
 -2.96867881e-02  7.59637356e-02 -1.28639089e-02 -1.03617705e-01
  3.53865586e-02  2.58285999e-02 -2.47355364e-02  3.14401388e-02
 -8.02845955e-02  2.78930962e-02 -2.51635928e-02  6.00934848e-02
  1.41579017e-01 -6.83199689e-02  5.87898865e-03 -1.83313601e-02
  4.06124964e-02 -6.60633519e-02 -1.19244955e-01  1.94623861e-02
 -6.28705993e-02 -4.04478423e-03 -7.40317851e-02 -7.25492388e-02
 -8.11627042e-03 -8.26193243e-02  8.88345316e-02  1.16606131e-02
  9.47007462e-02 -5.83177619e-02 -1.45221679e-02  6.16157020e-04
 -6.31113127e-02 -2.50887964e-02  6.01872280e-02  1.59547906e-02
 -9.67522245e-03 -3.58564146e-02 -3.93492617e-02 -9.13486406e-02
 -2.90397182e-02  1.78669058e-02  3.34740318e-02 -8.36239941e-03
 -1.95192583e-02 -2.73503587e-02 -1.63460951e-02  7.58995244e-04
  1.23664429e-02 -3.73883285e-02  5.00804037e-02 -4.30539809e-02
 -2.83194818e-02 -8.58169198e-02  3.73673216e-02 -2.92865876e-02
  1.75534897e-02  7.48214424e-02  7.75343776e-02  3.09614297e-02
 -3.30737382e-02 -2.35913671e-03  6.85290694e-02  7.56176412e-02
  2.73576658e-02 -2.17721872e-02 -3.11366692e-02 -2.95001445e-08
 -1.00294635e-01 -5.97752025e-03 -1.45322438e-02  4.12067724e-03
 -4.15112302e-02  4.98973019e-02 -4.00561839e-02 -9.23530012e-02
 -5.00793830e-02  6.81857765e-02  5.59744686e-02  3.74855697e-02
  7.26384744e-02  6.83505367e-03  6.03531711e-02 -3.61361839e-02
 -1.70280710e-02  6.65589795e-02 -4.19225059e-02 -3.05674858e-02
 -1.38555234e-03 -5.29974066e-02  7.51253143e-02 -1.14122778e-02
 -3.71169597e-02  4.89340920e-04 -2.31129415e-02  1.08276069e-01
  9.56613850e-03  2.30067596e-02  1.12477811e-02  5.65626211e-02
 -5.62738329e-02 -3.46402302e-02 -1.52198616e-02  6.62029255e-03
 -2.27477606e-02 -2.88072508e-02  3.93441990e-02  1.34451002e-01
 -7.62379766e-02  1.28213987e-02  3.41233499e-02  6.04857877e-02
 -1.56266347e-03  1.20424759e-02  2.62812283e-02 -8.15650821e-02
  9.83375907e-02  3.58882919e-02 -3.18557471e-02 -2.28076037e-02
  1.51444301e-02 -2.02483051e-02  4.78964578e-03  6.85615316e-02
 -2.05330160e-02 -2.06888318e-02 -1.37732625e-01  7.76482448e-02
  1.16653182e-02 -4.74089794e-02 -8.70513692e-02  5.17047793e-02]
After quantization: 
 [116 121  82 101  81 141 125 135 104 153 220 119 122 135 160 170 107 167
 125 131 110 129 178 144  97 101 171  74 103  76 118 122  73 165  73 164
 175 104 107 156  74  77 154 108 121 116 154  67 184 134 130 104 155 129
 121  77 155  97 107 141 187 147 110 155  89  84 117 133 126 109 140 126
  94 146 161  90 194 168 161 141  96 153 160  90 144 145 100 168  96 108
 136 163  38 120  77 160 109 159  77 179  71 189 196 159  79  56 168 112
 172 121 153  56  74 132 140 182 146  96  51  76 119 141 186 154 112  77
  49 129 171 152 174 157 170 120 136 157 149 136 110 107 177 113 148  68
  92  87 110 122 207 158 147  94  90 187 252 147 213 151 103  88  86  53
 216  86 117 145 134 141 149 107 195 130  96 174 251 120 112 102  28 170
 126 102 170 101 179 110  85 122  96 176  98 170  75  66 146  57 202 100
  68 156  79 122 110 145 104 130 123  85 146 112 166 166  72 116 120  68
 108 173 108 147 172 157 162 128 156 130  78 116 227 141 135 180 115  91
 193 118 124 124 228 156 134 135  91 127 218 206 160  80 117 109 242 137
 105 190 118  45 157 149 109 154  64 151 108 177 243  73 133 114 161  75
  32 144  78 125  69  70 122  62 200 138 205  82 117 129  78 108 177 141
 121 100  97  55 105 143 155 122 113 106 115 129 138  98 169  94 106  59
 159 105 143 189 191 153 102 127 184 189 151 111 103 128  48 124 117 132
  95 169  96  54  88 183 174 159 187 134 177  99 115 182  95 104 127  86
 189 119  99 129 110 216 136 147 138 174  83 101 116 134 110 105 160 237
  67 139 156 177 127 138 150  63 208 157 103 110 141 112 132 184 112 112
  18 191 138  90  58 170]
i = 0	fp32 square sum: 1.0000003576278687	int8 square sum: 1.0008548498153687
i = 1	fp32 square sum: 0.9999998211860657	int8 square sum: 0.9988714456558228
i = 2	fp32 square sum: 0.9999995231628418	int8 square sum: 0.9994643330574036
i = 3	fp32 square sum: 1.0000001192092896	int8 square sum: 0.9875189661979675
i = 4	fp32 square sum: 1.0000003576278687	int8 square sum: 1.001016616821289
i = 5	fp32 square sum: 1.000000238418579	int8 square sum: 1.0002450942993164
i = 6	fp32 square sum: 1.0000001192092896	int8 square sum: 1.0007177591323853
i = 7	fp32 square sum: 0.9999995231628418	int8 square sum: 0.9991425275802612
i = 8	fp32 square sum: 1.0000001192092896	int8 square sum: 0.9894008636474609
i = 9	fp32 square sum: 0.9999998211860657	int8 square sum: 1.000842571258545
Building...
add 0:100000, 0.113 s add 100000:200000, 0.219 s add 200000:300000, 0.405 s add 300000:400000, 0.682 s add 400000:500000, 0.791 s Searching...
R@1 = 0.9280
R@10 = 0.9820
R@100 = 0.9970
Experiment int8... scale factor = 0.11948662996292114
Before quantization: 
 [-1.49867618e-02 -9.68345348e-03 -5.79111241e-02 -3.40401605e-02
 -5.84010631e-02  1.54728433e-02 -3.74758942e-03  8.23296420e-03
 -3.01494971e-02  3.08102649e-02  1.13890767e-01 -1.14366421e-02
 -8.46892875e-03  7.74566829e-03  3.95780094e-02  5.17672338e-02
 -2.68540829e-02  4.80111353e-02 -4.65955725e-03  3.34247504e-03
 -2.29886174e-02  1.94406020e-04  6.12896234e-02  1.89975984e-02
 -3.93570587e-02 -3.40035483e-02  5.29002696e-02 -6.73171431e-02
 -3.18305343e-02 -6.47372678e-02 -1.28957117e-02 -7.79697532e-03
 -6.84998110e-02  4.49257270e-02 -6.86620697e-02  4.43314910e-02
  5.74522875e-02 -3.08865830e-02 -2.62973495e-02  3.40816341e-02
 -6.78526089e-02 -6.41803890e-02  3.15261297e-02 -2.51773596e-02
 -9.34352726e-03 -1.55171724e-02  3.13819274e-02 -7.63133019e-02
  6.93198517e-02  6.35677762e-03  1.47650717e-03 -2.98002828e-02
  3.32436226e-02  1.20005116e-03 -9.14921984e-03 -6.41457438e-02
  3.25135961e-02 -3.86229344e-02 -2.61718389e-02  1.49117317e-02
  7.21704364e-02  2.35404242e-02 -2.27502938e-02  3.32574919e-02
 -4.88067493e-02 -5.55564277e-02 -1.45545555e-02  5.07149147e-03
 -3.56880506e-03 -2.36863233e-02  1.40741933e-02 -3.48075340e-03
 -4.31204736e-02  2.18455698e-02  4.06909883e-02 -4.77637202e-02
  8.16162080e-02  4.87731695e-02  4.01032642e-02  1.57765877e-02
 -4.08191793e-02  3.03414892e-02  3.87875251e-02 -4.71578874e-02
  1.88364442e-02  2.05781907e-02 -3.56025845e-02  4.92872447e-02
 -4.04932089e-02 -2.56460179e-02  9.42029618e-03  4.22992446e-02
 -1.11963868e-01 -1.08125117e-02 -6.35822639e-02  3.87455001e-02
 -2.47221589e-02  3.78200226e-02 -6.44943863e-02  6.30875379e-02
 -7.12282583e-02  7.53201842e-02  8.37952569e-02  3.81772481e-02
 -6.15315251e-02 -8.99483860e-02  4.84602414e-02 -2.01212522e-02
  5.39325178e-02 -9.89652332e-03  3.09501532e-02 -8.99807066e-02
 -6.74129277e-02  4.07188386e-03  1.38107147e-02  6.58543482e-02
  2.16003526e-02 -4.01584692e-02 -9.61588919e-02 -6.52997345e-02
 -1.19673759e-02  1.56386346e-02  7.09095821e-02  3.20403911e-02
 -2.00403128e-02 -6.43938407e-02 -9.91705731e-02  2.62832570e-34
  5.33027761e-02  2.87559871e-02  5.68117984e-02  3.57985310e-02
  5.17026037e-02 -1.00081079e-02  8.73631053e-03  3.53132039e-02
  2.50439458e-02  9.54495557e-03 -2.23834850e-02 -2.68531516e-02
  6.06561787e-02 -1.91564728e-02  2.37346515e-02 -7.54912421e-02
 -4.46815826e-02 -5.08830957e-02 -2.28309687e-02 -8.40491522e-03
  9.68801826e-02  3.63240428e-02  2.32038852e-02 -4.30141464e-02
 -4.80103493e-02  7.30274841e-02  1.53448552e-01  2.32242756e-02
  1.04601488e-01  2.84230933e-02 -3.12963352e-02 -5.08695543e-02
 -5.30726090e-02 -9.35416222e-02  1.08407155e-01 -5.30931279e-02
 -1.41807878e-02  2.00267918e-02  6.61519729e-03  1.56937242e-02
  2.58342959e-02 -2.64351722e-02  8.31351876e-02  2.05967063e-03
 -3.99919711e-02  5.59228621e-02  1.51585996e-01 -1.06778312e-02
 -2.06448305e-02 -3.34620029e-02 -1.24203831e-01  5.15222922e-02
 -3.28843878e-03 -3.30695100e-02  5.16825318e-02 -3.40045244e-02
  6.23184480e-02 -2.29074862e-02 -5.42399734e-02 -8.67629796e-03
 -3.97358090e-02  5.86575903e-02 -3.74881066e-02  5.10992892e-02
 -6.59760162e-02 -7.75630474e-02  2.23245677e-02 -8.87607560e-02
  9.07822847e-02 -3.51750888e-02 -7.51072094e-02  3.44051160e-02
 -6.14057630e-02 -8.57327692e-03 -2.24762894e-02  2.09367536e-02
 -3.09693497e-02  1.41246675e-03 -6.83588721e-03 -5.43593615e-02
  2.11986210e-02 -2.05597077e-02  4.65770438e-02  4.59764935e-02
 -6.99426904e-02 -1.52349640e-02 -1.04732588e-02 -7.49177486e-02
 -2.55625006e-02  5.47486879e-02 -2.50392798e-02  2.31649559e-02
  5.35149723e-02  3.50459442e-02  4.20869142e-02 -2.63932130e-33
  3.37502584e-02  1.73416326e-03 -6.24770448e-02 -1.58950407e-02
  1.22457102e-01  1.57097261e-02  8.38483963e-03  6.33168370e-02
 -1.66476108e-02 -4.66118678e-02  7.96821415e-02 -1.30651994e-02
 -5.72722498e-03 -5.54403523e-03  1.23275213e-01  3.43351103e-02
  7.27453455e-03  7.61426380e-03 -4.59552035e-02 -2.19059619e-03
  1.11198932e-01  9.65301916e-02  3.89098674e-02 -6.07600659e-02
 -1.44319925e-02 -2.37527546e-02  1.40748173e-01  1.01559199e-02
 -2.96867881e-02  7.59637356e-02 -1.28639089e-02 -1.03617705e-01
  3.53865586e-02  2.58285999e-02 -2.47355364e-02  3.14401388e-02
 -8.02845955e-02  2.78930962e-02 -2.51635928e-02  6.00934848e-02
  1.41579017e-01 -6.83199689e-02  5.87898865e-03 -1.83313601e-02
  4.06124964e-02 -6.60633519e-02 -1.19244955e-01  1.94623861e-02
 -6.28705993e-02 -4.04478423e-03 -7.40317851e-02 -7.25492388e-02
 -8.11627042e-03 -8.26193243e-02  8.88345316e-02  1.16606131e-02
  9.47007462e-02 -5.83177619e-02 -1.45221679e-02  6.16157020e-04
 -6.31113127e-02 -2.50887964e-02  6.01872280e-02  1.59547906e-02
 -9.67522245e-03 -3.58564146e-02 -3.93492617e-02 -9.13486406e-02
 -2.90397182e-02  1.78669058e-02  3.34740318e-02 -8.36239941e-03
 -1.95192583e-02 -2.73503587e-02 -1.63460951e-02  7.58995244e-04
  1.23664429e-02 -3.73883285e-02  5.00804037e-02 -4.30539809e-02
 -2.83194818e-02 -8.58169198e-02  3.73673216e-02 -2.92865876e-02
  1.75534897e-02  7.48214424e-02  7.75343776e-02  3.09614297e-02
 -3.30737382e-02 -2.35913671e-03  6.85290694e-02  7.56176412e-02
  2.73576658e-02 -2.17721872e-02 -3.11366692e-02 -2.95001445e-08
 -1.00294635e-01 -5.97752025e-03 -1.45322438e-02  4.12067724e-03
 -4.15112302e-02  4.98973019e-02 -4.00561839e-02 -9.23530012e-02
 -5.00793830e-02  6.81857765e-02  5.59744686e-02  3.74855697e-02
  7.26384744e-02  6.83505367e-03  6.03531711e-02 -3.61361839e-02
 -1.70280710e-02  6.65589795e-02 -4.19225059e-02 -3.05674858e-02
 -1.38555234e-03 -5.29974066e-02  7.51253143e-02 -1.14122778e-02
 -3.71169597e-02  4.89340920e-04 -2.31129415e-02  1.08276069e-01
  9.56613850e-03  2.30067596e-02  1.12477811e-02  5.65626211e-02
 -5.62738329e-02 -3.46402302e-02 -1.52198616e-02  6.62029255e-03
 -2.27477606e-02 -2.88072508e-02  3.93441990e-02  1.34451002e-01
 -7.62379766e-02  1.28213987e-02  3.41233499e-02  6.04857877e-02
 -1.56266347e-03  1.20424759e-02  2.62812283e-02 -8.15650821e-02
  9.83375907e-02  3.58882919e-02 -3.18557471e-02 -2.28076037e-02
  1.51444301e-02 -2.02483051e-02  4.78964578e-03  6.85615316e-02
 -2.05330160e-02 -2.06888318e-02 -1.37732625e-01  7.76482448e-02
  1.16653182e-02 -4.74089794e-02 -8.70513692e-02  5.17047793e-02]
After quantization: 
 [ 96 108   4  56   3 162 120 146  64 195 256 104 110 145 213 239  71 231
 119 136  79 129 256 169  44  56 242   0  60   0 101 112   0 225   0 223
 252  62  72 202   0   0 196  75 108  95 196   0 256 142 132  65 200 131
 109   0 198  46  72 160 256 179  80 200  24   9  97 139 121  78 159 121
  36 175 216  26 256 233 214 162  41 194 212  27 169 173  52 234  42  74
 149 219   0 105   0 212  76 210   0 256   0 256 256 210   0   0 232  85
 244 107 195   0   0 137 158 256 175  42   0   0 103 162 256 197  86   0
   0 129 243 190 250 205 239 107 147 204 182 149  81  71 256  87 179   0
  33  19  80 110 256 206 178  36  26 256 256 178 256 189  61  20  15   0
 256  15  98 171 143 162 184  72 256 133  43 248 256 106  84  57   0 239
 121  58 239  56 256  79  12 110  43 254  48 238   0   0 176   0 256  53
   0 202   0 110  80 173  62 132 114  12 174  84 228 227   0  96 106   0
  74 246  75 178 243 204 219 128 201 132   0  94 256 162 146 256  93  29
 256 101 116 117 256 202 144 145  30 124 256 256 212   0  98  78 256 150
  65 256 101   0 204 184  76 196   0 188  75 256 256   0 141  89 216   0
   0 170   0 120   0   0 111   0 256 153 256   4  97 130   0  75 256 163
 108  52  44   0  66 167 200 111  87  70  93 130 155  48 236  36  68   0
 209  66 166 256 256 195  58 123 256 256 187  82  62 128   0 116  97 137
  40 235  43   0  21 256 248 209 256 143 256  51  92 256  39  63 126  15
 256 104  49 130  79 256 149 178 153 250   8  54  96 143  80  67 213 256
   0 156 202 256 125 154 185   0 256 205  60  80 161  85 139 256  85  84
   0 256 153  27   0 239]
i = 0	fp32 square sum: 1.0000003576278687	int8 square sum: 0.6225489377975464
i = 1	fp32 square sum: 0.9999998211860657	int8 square sum: 0.6165844202041626
i = 2	fp32 square sum: 0.9999995231628418	int8 square sum: 0.6147156953811646
i = 3	fp32 square sum: 1.0000001192092896	int8 square sum: 0.6244906187057495
i = 4	fp32 square sum: 1.0000003576278687	int8 square sum: 0.6326901316642761
i = 5	fp32 square sum: 1.000000238418579	int8 square sum: 0.610359787940979
i = 6	fp32 square sum: 1.0000001192092896	int8 square sum: 0.6382406949996948
i = 7	fp32 square sum: 0.9999995231628418	int8 square sum: 0.6019386053085327
i = 8	fp32 square sum: 1.0000001192092896	int8 square sum: 0.6142944097518921
i = 9	fp32 square sum: 0.9999998211860657	int8 square sum: 0.6486864686012268
Building...
add 0:100000, 0.112 s add 100000:200000, 0.219 s add 200000:300000, 0.406 s add 300000:400000, 0.682 s add 400000:500000, 0.790 s Searching...
R@1 = 0.7470
R@10 = 0.9670
R@100 = 0.9910
Experiment int12... scale factor = 0.3176809847354889
Before quantization: 
 [-1.49867618e-02 -9.68345348e-03 -5.79111241e-02 -3.40401605e-02
 -5.84010631e-02  1.54728433e-02 -3.74758942e-03  8.23296420e-03
 -3.01494971e-02  3.08102649e-02  1.13890767e-01 -1.14366421e-02
 -8.46892875e-03  7.74566829e-03  3.95780094e-02  5.17672338e-02
 -2.68540829e-02  4.80111353e-02 -4.65955725e-03  3.34247504e-03
 -2.29886174e-02  1.94406020e-04  6.12896234e-02  1.89975984e-02
 -3.93570587e-02 -3.40035483e-02  5.29002696e-02 -6.73171431e-02
 -3.18305343e-02 -6.47372678e-02 -1.28957117e-02 -7.79697532e-03
 -6.84998110e-02  4.49257270e-02 -6.86620697e-02  4.43314910e-02
  5.74522875e-02 -3.08865830e-02 -2.62973495e-02  3.40816341e-02
 -6.78526089e-02 -6.41803890e-02  3.15261297e-02 -2.51773596e-02
 -9.34352726e-03 -1.55171724e-02  3.13819274e-02 -7.63133019e-02
  6.93198517e-02  6.35677762e-03  1.47650717e-03 -2.98002828e-02
  3.32436226e-02  1.20005116e-03 -9.14921984e-03 -6.41457438e-02
  3.25135961e-02 -3.86229344e-02 -2.61718389e-02  1.49117317e-02
  7.21704364e-02  2.35404242e-02 -2.27502938e-02  3.32574919e-02
 -4.88067493e-02 -5.55564277e-02 -1.45545555e-02  5.07149147e-03
 -3.56880506e-03 -2.36863233e-02  1.40741933e-02 -3.48075340e-03
 -4.31204736e-02  2.18455698e-02  4.06909883e-02 -4.77637202e-02
  8.16162080e-02  4.87731695e-02  4.01032642e-02  1.57765877e-02
 -4.08191793e-02  3.03414892e-02  3.87875251e-02 -4.71578874e-02
  1.88364442e-02  2.05781907e-02 -3.56025845e-02  4.92872447e-02
 -4.04932089e-02 -2.56460179e-02  9.42029618e-03  4.22992446e-02
 -1.11963868e-01 -1.08125117e-02 -6.35822639e-02  3.87455001e-02
 -2.47221589e-02  3.78200226e-02 -6.44943863e-02  6.30875379e-02
 -7.12282583e-02  7.53201842e-02  8.37952569e-02  3.81772481e-02
 -6.15315251e-02 -8.99483860e-02  4.84602414e-02 -2.01212522e-02
  5.39325178e-02 -9.89652332e-03  3.09501532e-02 -8.99807066e-02
 -6.74129277e-02  4.07188386e-03  1.38107147e-02  6.58543482e-02
  2.16003526e-02 -4.01584692e-02 -9.61588919e-02 -6.52997345e-02
 -1.19673759e-02  1.56386346e-02  7.09095821e-02  3.20403911e-02
 -2.00403128e-02 -6.43938407e-02 -9.91705731e-02  2.62832570e-34
  5.33027761e-02  2.87559871e-02  5.68117984e-02  3.57985310e-02
  5.17026037e-02 -1.00081079e-02  8.73631053e-03  3.53132039e-02
  2.50439458e-02  9.54495557e-03 -2.23834850e-02 -2.68531516e-02
  6.06561787e-02 -1.91564728e-02  2.37346515e-02 -7.54912421e-02
 -4.46815826e-02 -5.08830957e-02 -2.28309687e-02 -8.40491522e-03
  9.68801826e-02  3.63240428e-02  2.32038852e-02 -4.30141464e-02
 -4.80103493e-02  7.30274841e-02  1.53448552e-01  2.32242756e-02
  1.04601488e-01  2.84230933e-02 -3.12963352e-02 -5.08695543e-02
 -5.30726090e-02 -9.35416222e-02  1.08407155e-01 -5.30931279e-02
 -1.41807878e-02  2.00267918e-02  6.61519729e-03  1.56937242e-02
  2.58342959e-02 -2.64351722e-02  8.31351876e-02  2.05967063e-03
 -3.99919711e-02  5.59228621e-02  1.51585996e-01 -1.06778312e-02
 -2.06448305e-02 -3.34620029e-02 -1.24203831e-01  5.15222922e-02
 -3.28843878e-03 -3.30695100e-02  5.16825318e-02 -3.40045244e-02
  6.23184480e-02 -2.29074862e-02 -5.42399734e-02 -8.67629796e-03
 -3.97358090e-02  5.86575903e-02 -3.74881066e-02  5.10992892e-02
 -6.59760162e-02 -7.75630474e-02  2.23245677e-02 -8.87607560e-02
  9.07822847e-02 -3.51750888e-02 -7.51072094e-02  3.44051160e-02
 -6.14057630e-02 -8.57327692e-03 -2.24762894e-02  2.09367536e-02
 -3.09693497e-02  1.41246675e-03 -6.83588721e-03 -5.43593615e-02
  2.11986210e-02 -2.05597077e-02  4.65770438e-02  4.59764935e-02
 -6.99426904e-02 -1.52349640e-02 -1.04732588e-02 -7.49177486e-02
 -2.55625006e-02  5.47486879e-02 -2.50392798e-02  2.31649559e-02
  5.35149723e-02  3.50459442e-02  4.20869142e-02 -2.63932130e-33
  3.37502584e-02  1.73416326e-03 -6.24770448e-02 -1.58950407e-02
  1.22457102e-01  1.57097261e-02  8.38483963e-03  6.33168370e-02
 -1.66476108e-02 -4.66118678e-02  7.96821415e-02 -1.30651994e-02
 -5.72722498e-03 -5.54403523e-03  1.23275213e-01  3.43351103e-02
  7.27453455e-03  7.61426380e-03 -4.59552035e-02 -2.19059619e-03
  1.11198932e-01  9.65301916e-02  3.89098674e-02 -6.07600659e-02
 -1.44319925e-02 -2.37527546e-02  1.40748173e-01  1.01559199e-02
 -2.96867881e-02  7.59637356e-02 -1.28639089e-02 -1.03617705e-01
  3.53865586e-02  2.58285999e-02 -2.47355364e-02  3.14401388e-02
 -8.02845955e-02  2.78930962e-02 -2.51635928e-02  6.00934848e-02
  1.41579017e-01 -6.83199689e-02  5.87898865e-03 -1.83313601e-02
  4.06124964e-02 -6.60633519e-02 -1.19244955e-01  1.94623861e-02
 -6.28705993e-02 -4.04478423e-03 -7.40317851e-02 -7.25492388e-02
 -8.11627042e-03 -8.26193243e-02  8.88345316e-02  1.16606131e-02
  9.47007462e-02 -5.83177619e-02 -1.45221679e-02  6.16157020e-04
 -6.31113127e-02 -2.50887964e-02  6.01872280e-02  1.59547906e-02
 -9.67522245e-03 -3.58564146e-02 -3.93492617e-02 -9.13486406e-02
 -2.90397182e-02  1.78669058e-02  3.34740318e-02 -8.36239941e-03
 -1.95192583e-02 -2.73503587e-02 -1.63460951e-02  7.58995244e-04
  1.23664429e-02 -3.73883285e-02  5.00804037e-02 -4.30539809e-02
 -2.83194818e-02 -8.58169198e-02  3.73673216e-02 -2.92865876e-02
  1.75534897e-02  7.48214424e-02  7.75343776e-02  3.09614297e-02
 -3.30737382e-02 -2.35913671e-03  6.85290694e-02  7.56176412e-02
  2.73576658e-02 -2.17721872e-02 -3.11366692e-02 -2.95001445e-08
 -1.00294635e-01 -5.97752025e-03 -1.45322438e-02  4.12067724e-03
 -4.15112302e-02  4.98973019e-02 -4.00561839e-02 -9.23530012e-02
 -5.00793830e-02  6.81857765e-02  5.59744686e-02  3.74855697e-02
  7.26384744e-02  6.83505367e-03  6.03531711e-02 -3.61361839e-02
 -1.70280710e-02  6.65589795e-02 -4.19225059e-02 -3.05674858e-02
 -1.38555234e-03 -5.29974066e-02  7.51253143e-02 -1.14122778e-02
 -3.71169597e-02  4.89340920e-04 -2.31129415e-02  1.08276069e-01
  9.56613850e-03  2.30067596e-02  1.12477811e-02  5.65626211e-02
 -5.62738329e-02 -3.46402302e-02 -1.52198616e-02  6.62029255e-03
 -2.27477606e-02 -2.88072508e-02  3.93441990e-02  1.34451002e-01
 -7.62379766e-02  1.28213987e-02  3.41233499e-02  6.04857877e-02
 -1.56266347e-03  1.20424759e-02  2.62812283e-02 -8.15650821e-02
  9.83375907e-02  3.58882919e-02 -3.18557471e-02 -2.28076037e-02
  1.51444301e-02 -2.02483051e-02  4.78964578e-03  6.85615316e-02
 -2.05330160e-02 -2.06888318e-02 -1.37732625e-01  7.76482448e-02
  1.16653182e-02 -4.74089794e-02 -8.70513692e-02  5.17047793e-02]
After quantization: 
 [1855 1924 1302 1610 1296 2248 2000 2155 1660 2446 3517 1901 1939 2148
 2559 2716 1702 2668 1988 2092 1752 2051 2839 2293 1541 1610 2731 1181
 1638 1214 1882 1948 1165 2628 1163 2620 2789 1650 1709 2488 1174 1221
 2455 1724 1928 1848 2453 1065 2942 2130 2068 1664 2477 2064 1931 1221
 2468 1551 1711 2241 2979 2352 1755 2477 1419 1332 1861 2114 2002 1743
 2230 2004 1493 2330 2573 1433 3101 2677 2566 2252 1522 2440 2549 1440
 2291 2314 1589 2684 1526 1718 2170 2594  605 1909 1229 2548 1730 2536
 1217 2862 1130 3020 3129 2541 1255  889 2673 1789 2744 1921 2448  888
 1179 2101 2227 2898 2327 1531  809 1207 1894 2250 2963 2462 1790 1218
  770 2049 2736 2419 2781 2510 2715 1919 2161 2504 2371 2172 1760 1702
 2831 1802 2355 1075 1472 1392 1754 1940 3298 2517 2348 1494 1429 2990
 4027 2348 3397 2415 1645 1393 1364  842 3446 1364 1866 2307 2134 2251
 2382 1708 3120 2075 1533 2770 4003 1911 1782 1617  447 2713 2006 1622
 2715 1610 2852 1753 1349 1937 1536 2805 1565 2707 1198 1048 2336  904
 3219 1595 1080 2492 1257 1938 1759 2318 1649 2067 1960 1348 2322 1783
 2649 2641 1147 1852 1913 1083 1719 2754 1726 2347 2738 2500 2591 2048
 2484 2071 1243 1844 3627 2251 2157 2865 1834 1448 3076 1880 1975 1977
 3638 2491 2142 2147 1456 2020 3482 3293 2550 1265 1862 1742 3863 2179
 1666 3028 1883  713 2505 2382 1730 2454 1013 2408 1724 2823 3874 1168
 2124 1812 2572 1197  511 2299 1238 1996 1094 1113 1944  983 3194 2199
 3270 1297 1861 2056 1235 1725 2825 2254 1924 1586 1541  871 1674 2279
 2480 1941 1797 1696 1838 2058 2208 1566 2694 1493 1683  942 2530 1671
 2275 3013 3048 2448 1622 2018 2932 3023 2401 1768 1647 2048  755 1971
 1861 2102 1513 2692 1532  858 1403 2928 2770 2532 2985 2137 2827 1583
 1829 2907 1508 1654 2031 1365 3017 1901 1570 2055 1750 3445 2172 2345
 2194 2778 1323 1602 1852 2134 1755 1677 2556 3782 1066 2214 2488 2828
 2028 2204 2387  997 3316 2511 1638 1754 2244 1787 2110 2932 1784 1782
  273 3050 2199 1437  926 2715]
i = 0	fp32 square sum: 1.0000003576278687	int12 square sum: 0.999997615814209
i = 1	fp32 square sum: 0.9999998211860657	int12 square sum: 0.9999827742576599
i = 2	fp32 square sum: 0.9999995231628418	int12 square sum: 1.0000529289245605
i = 3	fp32 square sum: 1.0000001192092896	int12 square sum: 0.9874829649925232
i = 4	fp32 square sum: 1.0000003576278687	int12 square sum: 0.9996953010559082
i = 5	fp32 square sum: 1.000000238418579	int12 square sum: 1.0000100135803223
i = 6	fp32 square sum: 1.0000001192092896	int12 square sum: 0.999972403049469
i = 7	fp32 square sum: 0.9999995231628418	int12 square sum: 0.9999585151672363
i = 8	fp32 square sum: 1.0000001192092896	int12 square sum: 0.9888611435890198
i = 9	fp32 square sum: 0.9999998211860657	int12 square sum: 1.0000698566436768
Building...
add 0:100000, 0.113 s add 100000:200000, 0.219 s add 200000:300000, 0.407 s add 300000:400000, 0.683 s add 400000:500000, 0.792 s Searching...
R@1 = 0.9270
R@10 = 0.9830
R@100 = 1.0000
Experiment int12... scale factor = 0.11948662996292114
Before quantization: 
 [-1.49867618e-02 -9.68345348e-03 -5.79111241e-02 -3.40401605e-02
 -5.84010631e-02  1.54728433e-02 -3.74758942e-03  8.23296420e-03
 -3.01494971e-02  3.08102649e-02  1.13890767e-01 -1.14366421e-02
 -8.46892875e-03  7.74566829e-03  3.95780094e-02  5.17672338e-02
 -2.68540829e-02  4.80111353e-02 -4.65955725e-03  3.34247504e-03
 -2.29886174e-02  1.94406020e-04  6.12896234e-02  1.89975984e-02
 -3.93570587e-02 -3.40035483e-02  5.29002696e-02 -6.73171431e-02
 -3.18305343e-02 -6.47372678e-02 -1.28957117e-02 -7.79697532e-03
 -6.84998110e-02  4.49257270e-02 -6.86620697e-02  4.43314910e-02
  5.74522875e-02 -3.08865830e-02 -2.62973495e-02  3.40816341e-02
 -6.78526089e-02 -6.41803890e-02  3.15261297e-02 -2.51773596e-02
 -9.34352726e-03 -1.55171724e-02  3.13819274e-02 -7.63133019e-02
  6.93198517e-02  6.35677762e-03  1.47650717e-03 -2.98002828e-02
  3.32436226e-02  1.20005116e-03 -9.14921984e-03 -6.41457438e-02
  3.25135961e-02 -3.86229344e-02 -2.61718389e-02  1.49117317e-02
  7.21704364e-02  2.35404242e-02 -2.27502938e-02  3.32574919e-02
 -4.88067493e-02 -5.55564277e-02 -1.45545555e-02  5.07149147e-03
 -3.56880506e-03 -2.36863233e-02  1.40741933e-02 -3.48075340e-03
 -4.31204736e-02  2.18455698e-02  4.06909883e-02 -4.77637202e-02
  8.16162080e-02  4.87731695e-02  4.01032642e-02  1.57765877e-02
 -4.08191793e-02  3.03414892e-02  3.87875251e-02 -4.71578874e-02
  1.88364442e-02  2.05781907e-02 -3.56025845e-02  4.92872447e-02
 -4.04932089e-02 -2.56460179e-02  9.42029618e-03  4.22992446e-02
 -1.11963868e-01 -1.08125117e-02 -6.35822639e-02  3.87455001e-02
 -2.47221589e-02  3.78200226e-02 -6.44943863e-02  6.30875379e-02
 -7.12282583e-02  7.53201842e-02  8.37952569e-02  3.81772481e-02
 -6.15315251e-02 -8.99483860e-02  4.84602414e-02 -2.01212522e-02
  5.39325178e-02 -9.89652332e-03  3.09501532e-02 -8.99807066e-02
 -6.74129277e-02  4.07188386e-03  1.38107147e-02  6.58543482e-02
  2.16003526e-02 -4.01584692e-02 -9.61588919e-02 -6.52997345e-02
 -1.19673759e-02  1.56386346e-02  7.09095821e-02  3.20403911e-02
 -2.00403128e-02 -6.43938407e-02 -9.91705731e-02  2.62832570e-34
  5.33027761e-02  2.87559871e-02  5.68117984e-02  3.57985310e-02
  5.17026037e-02 -1.00081079e-02  8.73631053e-03  3.53132039e-02
  2.50439458e-02  9.54495557e-03 -2.23834850e-02 -2.68531516e-02
  6.06561787e-02 -1.91564728e-02  2.37346515e-02 -7.54912421e-02
 -4.46815826e-02 -5.08830957e-02 -2.28309687e-02 -8.40491522e-03
  9.68801826e-02  3.63240428e-02  2.32038852e-02 -4.30141464e-02
 -4.80103493e-02  7.30274841e-02  1.53448552e-01  2.32242756e-02
  1.04601488e-01  2.84230933e-02 -3.12963352e-02 -5.08695543e-02
 -5.30726090e-02 -9.35416222e-02  1.08407155e-01 -5.30931279e-02
 -1.41807878e-02  2.00267918e-02  6.61519729e-03  1.56937242e-02
  2.58342959e-02 -2.64351722e-02  8.31351876e-02  2.05967063e-03
 -3.99919711e-02  5.59228621e-02  1.51585996e-01 -1.06778312e-02
 -2.06448305e-02 -3.34620029e-02 -1.24203831e-01  5.15222922e-02
 -3.28843878e-03 -3.30695100e-02  5.16825318e-02 -3.40045244e-02
  6.23184480e-02 -2.29074862e-02 -5.42399734e-02 -8.67629796e-03
 -3.97358090e-02  5.86575903e-02 -3.74881066e-02  5.10992892e-02
 -6.59760162e-02 -7.75630474e-02  2.23245677e-02 -8.87607560e-02
  9.07822847e-02 -3.51750888e-02 -7.51072094e-02  3.44051160e-02
 -6.14057630e-02 -8.57327692e-03 -2.24762894e-02  2.09367536e-02
 -3.09693497e-02  1.41246675e-03 -6.83588721e-03 -5.43593615e-02
  2.11986210e-02 -2.05597077e-02  4.65770438e-02  4.59764935e-02
 -6.99426904e-02 -1.52349640e-02 -1.04732588e-02 -7.49177486e-02
 -2.55625006e-02  5.47486879e-02 -2.50392798e-02  2.31649559e-02
  5.35149723e-02  3.50459442e-02  4.20869142e-02 -2.63932130e-33
  3.37502584e-02  1.73416326e-03 -6.24770448e-02 -1.58950407e-02
  1.22457102e-01  1.57097261e-02  8.38483963e-03  6.33168370e-02
 -1.66476108e-02 -4.66118678e-02  7.96821415e-02 -1.30651994e-02
 -5.72722498e-03 -5.54403523e-03  1.23275213e-01  3.43351103e-02
  7.27453455e-03  7.61426380e-03 -4.59552035e-02 -2.19059619e-03
  1.11198932e-01  9.65301916e-02  3.89098674e-02 -6.07600659e-02
 -1.44319925e-02 -2.37527546e-02  1.40748173e-01  1.01559199e-02
 -2.96867881e-02  7.59637356e-02 -1.28639089e-02 -1.03617705e-01
  3.53865586e-02  2.58285999e-02 -2.47355364e-02  3.14401388e-02
 -8.02845955e-02  2.78930962e-02 -2.51635928e-02  6.00934848e-02
  1.41579017e-01 -6.83199689e-02  5.87898865e-03 -1.83313601e-02
  4.06124964e-02 -6.60633519e-02 -1.19244955e-01  1.94623861e-02
 -6.28705993e-02 -4.04478423e-03 -7.40317851e-02 -7.25492388e-02
 -8.11627042e-03 -8.26193243e-02  8.88345316e-02  1.16606131e-02
  9.47007462e-02 -5.83177619e-02 -1.45221679e-02  6.16157020e-04
 -6.31113127e-02 -2.50887964e-02  6.01872280e-02  1.59547906e-02
 -9.67522245e-03 -3.58564146e-02 -3.93492617e-02 -9.13486406e-02
 -2.90397182e-02  1.78669058e-02  3.34740318e-02 -8.36239941e-03
 -1.95192583e-02 -2.73503587e-02 -1.63460951e-02  7.58995244e-04
  1.23664429e-02 -3.73883285e-02  5.00804037e-02 -4.30539809e-02
 -2.83194818e-02 -8.58169198e-02  3.73673216e-02 -2.92865876e-02
  1.75534897e-02  7.48214424e-02  7.75343776e-02  3.09614297e-02
 -3.30737382e-02 -2.35913671e-03  6.85290694e-02  7.56176412e-02
  2.73576658e-02 -2.17721872e-02 -3.11366692e-02 -2.95001445e-08
 -1.00294635e-01 -5.97752025e-03 -1.45322438e-02  4.12067724e-03
 -4.15112302e-02  4.98973019e-02 -4.00561839e-02 -9.23530012e-02
 -5.00793830e-02  6.81857765e-02  5.59744686e-02  3.74855697e-02
  7.26384744e-02  6.83505367e-03  6.03531711e-02 -3.61361839e-02
 -1.70280710e-02  6.65589795e-02 -4.19225059e-02 -3.05674858e-02
 -1.38555234e-03 -5.29974066e-02  7.51253143e-02 -1.14122778e-02
 -3.71169597e-02  4.89340920e-04 -2.31129415e-02  1.08276069e-01
  9.56613850e-03  2.30067596e-02  1.12477811e-02  5.65626211e-02
 -5.62738329e-02 -3.46402302e-02 -1.52198616e-02  6.62029255e-03
 -2.27477606e-02 -2.88072508e-02  3.93441990e-02  1.34451002e-01
 -7.62379766e-02  1.28213987e-02  3.41233499e-02  6.04857877e-02
 -1.56266347e-03  1.20424759e-02  2.62812283e-02 -8.15650821e-02
  9.83375907e-02  3.58882919e-02 -3.18557471e-02 -2.28076037e-02
  1.51444301e-02 -2.02483051e-02  4.78964578e-03  6.85615316e-02
 -2.05330160e-02 -2.06888318e-02 -1.37732625e-01  7.76482448e-02
  1.16653182e-02 -4.74089794e-02 -8.70513692e-02  5.17047793e-02]
After quantization: 
 [1535 1717   63  882   47 2579 1920 2331 1015 3105 4096 1656 1758 2314
 3405 3823 1128 3694 1889 2163 1260 2055 4096 2700  699  883 3862    0
  957    0 1606 1781    0 3589    0 3568 4018  990 1147 3217    0    0
 3129 1185 1728 1517 3124    0 4096 2266 2099 1027 3188 2090 1735    0
 3163  725 1151 2560 4096 2855 1269 3189  375  144 1550 2222 1926 1237
 2531 1929  570 2797 3443  411 4096 3720 3423 2589  649 3089 3378  432
 2694 2754  828 3738  660 1169 2371 3499    0 1678    0 3377 1201 3345
    0 4096    0 4096 4096 3357    0    0 3710 1359 3897 1709 3109    0
    0 2188 2522 4096 2789  672    0    0 1638 2585 4096 3147 1362    0
    0 2049 3876 3034 3996 3276 3821 1705 2348 3259 2907 2376 1281 1128
 4096 1392 2862    0  517  304 1266 1760 4096 3294 2844  574  403 4096
 4096 2845 4096 3023  976  305  229    0 4096  228 1562 2735 2275 2586
 2934 1142 4096 2119  678 3966 4096 1682 1341  901    0 3815 1936  915
 3820  883 4096 1263  189 1751  686 4059  763 3800    0    0 2814    0
 4096  843    0 3228    0 1755 1278 2766  987 2097 1814  185 2775 1344
 3645 3625    0 1526 1689    0 1172 3925 1190 2843 3883 3250 3491 2048
 3205 2108    0 1504 4096 2587 2336 4096 1478  451 4096 1601 1852 1858
 4096 3226 2298 2310  473 1973 4096 4096 3382    0 1554 1234 4096 2397
 1031 4096 1608    0 3262 2934 1201 3126    0 3005 1186 4096 4096    0
 2250 1420 3441    0    0 2716    0 1910    0    0 1770    0 4096 2448
 4096   49 1551 2070    0 1188 4096 2595 1717  819  700    0 1053 2661
 3196 1762 1379 1111 1488 2075 2472  767 3765  573 1078    0 3329 1045
 2650 4096 4096 3110  915 1968 4096 4096 2986 1302  981 2048    0 1844
 1550 2190  625 3759  675    0  332 4096 3967 3334 4096 2283 4096  810
 1465 4096  611 1001 2001  232 4096 1657  776 2065 1256 4096 2376 2837
 2434 3987  119  861 1527 2275 1269 1061 3397 4096    0 2488 3218 4096
 1995 2461 2949    0 4096 3279  956 1267 2568 1354 2213 4096 1345 1339
    0 4096 2448  423    0 3821]
i = 0	fp32 square sum: 1.0000003576278687	int12 square sum: 0.6227134466171265
i = 1	fp32 square sum: 0.9999998211860657	int12 square sum: 0.6166212558746338
i = 2	fp32 square sum: 0.9999995231628418	int12 square sum: 0.6143478155136108
i = 3	fp32 square sum: 1.0000001192092896	int12 square sum: 0.6246991157531738
i = 4	fp32 square sum: 1.0000003576278687	int12 square sum: 0.6327504515647888
i = 5	fp32 square sum: 1.000000238418579	int12 square sum: 0.6099221706390381
i = 6	fp32 square sum: 1.0000001192092896	int12 square sum: 0.6380832195281982
i = 7	fp32 square sum: 0.9999995231628418	int12 square sum: 0.6019460558891296
i = 8	fp32 square sum: 1.0000001192092896	int12 square sum: 0.6146605014801025
i = 9	fp32 square sum: 0.9999998211860657	int12 square sum: 0.6487044095993042
Building...
add 0:100000, 0.112 s add 100000:200000, 0.218 s add 200000:300000, 0.409 s add 300000:400000, 0.690 s add 400000:500000, 0.799 s Searching...
R@1 = 0.7490
R@10 = 0.9660
R@100 = 0.9940
Experiment int16... scale factor = 0.3176809847354889
Before quantization: 
 [-1.49867618e-02 -9.68345348e-03 -5.79111241e-02 -3.40401605e-02
 -5.84010631e-02  1.54728433e-02 -3.74758942e-03  8.23296420e-03
 -3.01494971e-02  3.08102649e-02  1.13890767e-01 -1.14366421e-02
 -8.46892875e-03  7.74566829e-03  3.95780094e-02  5.17672338e-02
 -2.68540829e-02  4.80111353e-02 -4.65955725e-03  3.34247504e-03
 -2.29886174e-02  1.94406020e-04  6.12896234e-02  1.89975984e-02
 -3.93570587e-02 -3.40035483e-02  5.29002696e-02 -6.73171431e-02
 -3.18305343e-02 -6.47372678e-02 -1.28957117e-02 -7.79697532e-03
 -6.84998110e-02  4.49257270e-02 -6.86620697e-02  4.43314910e-02
  5.74522875e-02 -3.08865830e-02 -2.62973495e-02  3.40816341e-02
 -6.78526089e-02 -6.41803890e-02  3.15261297e-02 -2.51773596e-02
 -9.34352726e-03 -1.55171724e-02  3.13819274e-02 -7.63133019e-02
  6.93198517e-02  6.35677762e-03  1.47650717e-03 -2.98002828e-02
  3.32436226e-02  1.20005116e-03 -9.14921984e-03 -6.41457438e-02
  3.25135961e-02 -3.86229344e-02 -2.61718389e-02  1.49117317e-02
  7.21704364e-02  2.35404242e-02 -2.27502938e-02  3.32574919e-02
 -4.88067493e-02 -5.55564277e-02 -1.45545555e-02  5.07149147e-03
 -3.56880506e-03 -2.36863233e-02  1.40741933e-02 -3.48075340e-03
 -4.31204736e-02  2.18455698e-02  4.06909883e-02 -4.77637202e-02
  8.16162080e-02  4.87731695e-02  4.01032642e-02  1.57765877e-02
 -4.08191793e-02  3.03414892e-02  3.87875251e-02 -4.71578874e-02
  1.88364442e-02  2.05781907e-02 -3.56025845e-02  4.92872447e-02
 -4.04932089e-02 -2.56460179e-02  9.42029618e-03  4.22992446e-02
 -1.11963868e-01 -1.08125117e-02 -6.35822639e-02  3.87455001e-02
 -2.47221589e-02  3.78200226e-02 -6.44943863e-02  6.30875379e-02
 -7.12282583e-02  7.53201842e-02  8.37952569e-02  3.81772481e-02
 -6.15315251e-02 -8.99483860e-02  4.84602414e-02 -2.01212522e-02
  5.39325178e-02 -9.89652332e-03  3.09501532e-02 -8.99807066e-02
 -6.74129277e-02  4.07188386e-03  1.38107147e-02  6.58543482e-02
  2.16003526e-02 -4.01584692e-02 -9.61588919e-02 -6.52997345e-02
 -1.19673759e-02  1.56386346e-02  7.09095821e-02  3.20403911e-02
 -2.00403128e-02 -6.43938407e-02 -9.91705731e-02  2.62832570e-34
  5.33027761e-02  2.87559871e-02  5.68117984e-02  3.57985310e-02
  5.17026037e-02 -1.00081079e-02  8.73631053e-03  3.53132039e-02
  2.50439458e-02  9.54495557e-03 -2.23834850e-02 -2.68531516e-02
  6.06561787e-02 -1.91564728e-02  2.37346515e-02 -7.54912421e-02
 -4.46815826e-02 -5.08830957e-02 -2.28309687e-02 -8.40491522e-03
  9.68801826e-02  3.63240428e-02  2.32038852e-02 -4.30141464e-02
 -4.80103493e-02  7.30274841e-02  1.53448552e-01  2.32242756e-02
  1.04601488e-01  2.84230933e-02 -3.12963352e-02 -5.08695543e-02
 -5.30726090e-02 -9.35416222e-02  1.08407155e-01 -5.30931279e-02
 -1.41807878e-02  2.00267918e-02  6.61519729e-03  1.56937242e-02
  2.58342959e-02 -2.64351722e-02  8.31351876e-02  2.05967063e-03
 -3.99919711e-02  5.59228621e-02  1.51585996e-01 -1.06778312e-02
 -2.06448305e-02 -3.34620029e-02 -1.24203831e-01  5.15222922e-02
 -3.28843878e-03 -3.30695100e-02  5.16825318e-02 -3.40045244e-02
  6.23184480e-02 -2.29074862e-02 -5.42399734e-02 -8.67629796e-03
 -3.97358090e-02  5.86575903e-02 -3.74881066e-02  5.10992892e-02
 -6.59760162e-02 -7.75630474e-02  2.23245677e-02 -8.87607560e-02
  9.07822847e-02 -3.51750888e-02 -7.51072094e-02  3.44051160e-02
 -6.14057630e-02 -8.57327692e-03 -2.24762894e-02  2.09367536e-02
 -3.09693497e-02  1.41246675e-03 -6.83588721e-03 -5.43593615e-02
  2.11986210e-02 -2.05597077e-02  4.65770438e-02  4.59764935e-02
 -6.99426904e-02 -1.52349640e-02 -1.04732588e-02 -7.49177486e-02
 -2.55625006e-02  5.47486879e-02 -2.50392798e-02  2.31649559e-02
  5.35149723e-02  3.50459442e-02  4.20869142e-02 -2.63932130e-33
  3.37502584e-02  1.73416326e-03 -6.24770448e-02 -1.58950407e-02
  1.22457102e-01  1.57097261e-02  8.38483963e-03  6.33168370e-02
 -1.66476108e-02 -4.66118678e-02  7.96821415e-02 -1.30651994e-02
 -5.72722498e-03 -5.54403523e-03  1.23275213e-01  3.43351103e-02
  7.27453455e-03  7.61426380e-03 -4.59552035e-02 -2.19059619e-03
  1.11198932e-01  9.65301916e-02  3.89098674e-02 -6.07600659e-02
 -1.44319925e-02 -2.37527546e-02  1.40748173e-01  1.01559199e-02
 -2.96867881e-02  7.59637356e-02 -1.28639089e-02 -1.03617705e-01
  3.53865586e-02  2.58285999e-02 -2.47355364e-02  3.14401388e-02
 -8.02845955e-02  2.78930962e-02 -2.51635928e-02  6.00934848e-02
  1.41579017e-01 -6.83199689e-02  5.87898865e-03 -1.83313601e-02
  4.06124964e-02 -6.60633519e-02 -1.19244955e-01  1.94623861e-02
 -6.28705993e-02 -4.04478423e-03 -7.40317851e-02 -7.25492388e-02
 -8.11627042e-03 -8.26193243e-02  8.88345316e-02  1.16606131e-02
  9.47007462e-02 -5.83177619e-02 -1.45221679e-02  6.16157020e-04
 -6.31113127e-02 -2.50887964e-02  6.01872280e-02  1.59547906e-02
 -9.67522245e-03 -3.58564146e-02 -3.93492617e-02 -9.13486406e-02
 -2.90397182e-02  1.78669058e-02  3.34740318e-02 -8.36239941e-03
 -1.95192583e-02 -2.73503587e-02 -1.63460951e-02  7.58995244e-04
  1.23664429e-02 -3.73883285e-02  5.00804037e-02 -4.30539809e-02
 -2.83194818e-02 -8.58169198e-02  3.73673216e-02 -2.92865876e-02
  1.75534897e-02  7.48214424e-02  7.75343776e-02  3.09614297e-02
 -3.30737382e-02 -2.35913671e-03  6.85290694e-02  7.56176412e-02
  2.73576658e-02 -2.17721872e-02 -3.11366692e-02 -2.95001445e-08
 -1.00294635e-01 -5.97752025e-03 -1.45322438e-02  4.12067724e-03
 -4.15112302e-02  4.98973019e-02 -4.00561839e-02 -9.23530012e-02
 -5.00793830e-02  6.81857765e-02  5.59744686e-02  3.74855697e-02
  7.26384744e-02  6.83505367e-03  6.03531711e-02 -3.61361839e-02
 -1.70280710e-02  6.65589795e-02 -4.19225059e-02 -3.05674858e-02
 -1.38555234e-03 -5.29974066e-02  7.51253143e-02 -1.14122778e-02
 -3.71169597e-02  4.89340920e-04 -2.31129415e-02  1.08276069e-01
  9.56613850e-03  2.30067596e-02  1.12477811e-02  5.65626211e-02
 -5.62738329e-02 -3.46402302e-02 -1.52198616e-02  6.62029255e-03
 -2.27477606e-02 -2.88072508e-02  3.93441990e-02  1.34451002e-01
 -7.62379766e-02  1.28213987e-02  3.41233499e-02  6.04857877e-02
 -1.56266347e-03  1.20424759e-02  2.62812283e-02 -8.15650821e-02
  9.83375907e-02  3.58882919e-02 -3.18557471e-02 -2.28076037e-02
  1.51444301e-02 -2.02483051e-02  4.78964578e-03  6.85615316e-02
 -2.05330160e-02 -2.06888318e-02 -1.37732625e-01  7.76482448e-02
  1.16653182e-02 -4.74089794e-02 -8.70513692e-02  5.17047793e-02]
After quantization: 
 [29677 30771 20822 25746 20721 35960 31995 34467 26549 39125 56264 30409
 31021 34366 40933 43448 27229 42673 31807 33458 28026 32809 45412 36688
 24649 25754 43682 18881 26202 19414 30108 31160 18637 42036 18604 41914
 44621 26397 27343 39799 18771 19528 39272 27575 30841 29567 39242 17025
 47069 34080 33073 26621 39626 33016 30881 19536 39476 24801 27369 35845
 47657 37625 28075 39629 22700 21307 29766 33815 32032 27882 35672 32050
 23873 37275 41163 22915 49606 42830 41042 36023 24348 39028 40770 23040
 36654 37014 25424 42936 24415 27478 34712 41495  9671 30538 19652 40762
 27668 40571 19464 45783 18074 48307 50055 40644 20075 14213 42766 28618
 43895 30727 39153 14206 18862 33609 35618 46354 37225 24484 12931 19297
 30300 35995 47397 39378 28634 19484 12310 32769 43765 38701 44488 40154
 43434 30704 34571 40053 37935 34738 28151 27229 45282 28817 37665 17195
 23551 22272 28059 31035 52754 40262 37555 23895 22864 47834 64424 37560
 54347 38632 26312 22274 21820 13471 55132 21816 29843 36900 34133 36006
 38098 27315 49919 33193 24518 44305 64040 30566 28510 25865  7146 43397
 32090 25946 43430 25754 45624 28043 21579 30979 24571 44869 25035 43310
 19158 16768 37374 14458 51496 25512 17274 39866 20101 31000 28132 37088
 26380 33060 31358 21554 37142 28527 42377 42253 18340 29626 30608 17313
 27495 44063 27603 37547 43808 39998 41451 32768 39731 33126 19880 29489
 58031 36009 34498 45830 29334 23153 49207 30073 31587 31625 58200 39852
 34269 34339 23288 32317 55708 52682 40795 20234 29791 27868 61804 34864
 26644 48439 30115 11393 40069 38097 27666 39254 16206 38523 27577 45165
 61976 18674 33981 28987 41147 19140  8169 36783 19799 31934 17496 17802
 31094 15725 51095 35174 52305 20738 29773 32896 19749 27593 45185 36060
 30773 25372 24651 13924 26778 36454 39674 31043 28742 27126 29396 32925
 35320 25055 43100 23887 26926 15065 40477 26727 36390 48204 48763 39156
 25946 32282 46906 48368 38412 28277 26345 32768 12078 31535 29771 33619
 24205 43062 24505 13717 22437 46835 44316 40502 47753 34179 45219 25314
 29256 46499 24120 26463 32483 21835 48266 30414 25111 32869 28000 55105
 34742 37515 35089 44437 21159 25622 29629 34134 28076 26826 40885 60505
 17041 35413 39808 45246 32446 35253 38190 15942 53055 40172 26197 28063
 35893 28591 33757 46912 28533 28500  4355 48787 35175 22988 14810 43435]
i = 0	fp32 square sum: 1.0000003576278687	int16 square sum: 0.999999002490715
i = 1	fp32 square sum: 0.9999998211860657	int16 square sum: 0.9999955749501162
i = 2	fp32 square sum: 0.9999995231628418	int16 square sum: 0.9999987322218968
i = 3	fp32 square sum: 1.0000001192092896	int16 square sum: 0.9873915649765894
i = 4	fp32 square sum: 1.0000003576278687	int16 square sum: 0.9996847846072696
i = 5	fp32 square sum: 1.000000238418579	int16 square sum: 0.9999969473480117
i = 6	fp32 square sum: 1.0000001192092896	int16 square sum: 0.9999986754283189
i = 7	fp32 square sum: 0.9999995231628418	int16 square sum: 1.0000012394339617
i = 8	fp32 square sum: 1.0000001192092896	int16 square sum: 0.988871752148499
i = 9	fp32 square sum: 0.9999998211860657	int16 square sum: 1.0000062586985858
Building...
add 0:100000, 0.112 s add 100000:200000, 0.218 s add 200000:300000, 0.406 s add 300000:400000, 0.682 s add 400000:500000, 0.791 s Searching...
R@1 = 0.9380
R@10 = 0.9740
R@100 = 0.9950
Experiment int16... scale factor = 0.11948662996292114
Before quantization: 
 [-1.49867618e-02 -9.68345348e-03 -5.79111241e-02 -3.40401605e-02
 -5.84010631e-02  1.54728433e-02 -3.74758942e-03  8.23296420e-03
 -3.01494971e-02  3.08102649e-02  1.13890767e-01 -1.14366421e-02
 -8.46892875e-03  7.74566829e-03  3.95780094e-02  5.17672338e-02
 -2.68540829e-02  4.80111353e-02 -4.65955725e-03  3.34247504e-03
 -2.29886174e-02  1.94406020e-04  6.12896234e-02  1.89975984e-02
 -3.93570587e-02 -3.40035483e-02  5.29002696e-02 -6.73171431e-02
 -3.18305343e-02 -6.47372678e-02 -1.28957117e-02 -7.79697532e-03
 -6.84998110e-02  4.49257270e-02 -6.86620697e-02  4.43314910e-02
  5.74522875e-02 -3.08865830e-02 -2.62973495e-02  3.40816341e-02
 -6.78526089e-02 -6.41803890e-02  3.15261297e-02 -2.51773596e-02
 -9.34352726e-03 -1.55171724e-02  3.13819274e-02 -7.63133019e-02
  6.93198517e-02  6.35677762e-03  1.47650717e-03 -2.98002828e-02
  3.32436226e-02  1.20005116e-03 -9.14921984e-03 -6.41457438e-02
  3.25135961e-02 -3.86229344e-02 -2.61718389e-02  1.49117317e-02
  7.21704364e-02  2.35404242e-02 -2.27502938e-02  3.32574919e-02
 -4.88067493e-02 -5.55564277e-02 -1.45545555e-02  5.07149147e-03
 -3.56880506e-03 -2.36863233e-02  1.40741933e-02 -3.48075340e-03
 -4.31204736e-02  2.18455698e-02  4.06909883e-02 -4.77637202e-02
  8.16162080e-02  4.87731695e-02  4.01032642e-02  1.57765877e-02
 -4.08191793e-02  3.03414892e-02  3.87875251e-02 -4.71578874e-02
  1.88364442e-02  2.05781907e-02 -3.56025845e-02  4.92872447e-02
 -4.04932089e-02 -2.56460179e-02  9.42029618e-03  4.22992446e-02
 -1.11963868e-01 -1.08125117e-02 -6.35822639e-02  3.87455001e-02
 -2.47221589e-02  3.78200226e-02 -6.44943863e-02  6.30875379e-02
 -7.12282583e-02  7.53201842e-02  8.37952569e-02  3.81772481e-02
 -6.15315251e-02 -8.99483860e-02  4.84602414e-02 -2.01212522e-02
  5.39325178e-02 -9.89652332e-03  3.09501532e-02 -8.99807066e-02
 -6.74129277e-02  4.07188386e-03  1.38107147e-02  6.58543482e-02
  2.16003526e-02 -4.01584692e-02 -9.61588919e-02 -6.52997345e-02
 -1.19673759e-02  1.56386346e-02  7.09095821e-02  3.20403911e-02
 -2.00403128e-02 -6.43938407e-02 -9.91705731e-02  2.62832570e-34
  5.33027761e-02  2.87559871e-02  5.68117984e-02  3.57985310e-02
  5.17026037e-02 -1.00081079e-02  8.73631053e-03  3.53132039e-02
  2.50439458e-02  9.54495557e-03 -2.23834850e-02 -2.68531516e-02
  6.06561787e-02 -1.91564728e-02  2.37346515e-02 -7.54912421e-02
 -4.46815826e-02 -5.08830957e-02 -2.28309687e-02 -8.40491522e-03
  9.68801826e-02  3.63240428e-02  2.32038852e-02 -4.30141464e-02
 -4.80103493e-02  7.30274841e-02  1.53448552e-01  2.32242756e-02
  1.04601488e-01  2.84230933e-02 -3.12963352e-02 -5.08695543e-02
 -5.30726090e-02 -9.35416222e-02  1.08407155e-01 -5.30931279e-02
 -1.41807878e-02  2.00267918e-02  6.61519729e-03  1.56937242e-02
  2.58342959e-02 -2.64351722e-02  8.31351876e-02  2.05967063e-03
 -3.99919711e-02  5.59228621e-02  1.51585996e-01 -1.06778312e-02
 -2.06448305e-02 -3.34620029e-02 -1.24203831e-01  5.15222922e-02
 -3.28843878e-03 -3.30695100e-02  5.16825318e-02 -3.40045244e-02
  6.23184480e-02 -2.29074862e-02 -5.42399734e-02 -8.67629796e-03
 -3.97358090e-02  5.86575903e-02 -3.74881066e-02  5.10992892e-02
 -6.59760162e-02 -7.75630474e-02  2.23245677e-02 -8.87607560e-02
  9.07822847e-02 -3.51750888e-02 -7.51072094e-02  3.44051160e-02
 -6.14057630e-02 -8.57327692e-03 -2.24762894e-02  2.09367536e-02
 -3.09693497e-02  1.41246675e-03 -6.83588721e-03 -5.43593615e-02
  2.11986210e-02 -2.05597077e-02  4.65770438e-02  4.59764935e-02
 -6.99426904e-02 -1.52349640e-02 -1.04732588e-02 -7.49177486e-02
 -2.55625006e-02  5.47486879e-02 -2.50392798e-02  2.31649559e-02
  5.35149723e-02  3.50459442e-02  4.20869142e-02 -2.63932130e-33
  3.37502584e-02  1.73416326e-03 -6.24770448e-02 -1.58950407e-02
  1.22457102e-01  1.57097261e-02  8.38483963e-03  6.33168370e-02
 -1.66476108e-02 -4.66118678e-02  7.96821415e-02 -1.30651994e-02
 -5.72722498e-03 -5.54403523e-03  1.23275213e-01  3.43351103e-02
  7.27453455e-03  7.61426380e-03 -4.59552035e-02 -2.19059619e-03
  1.11198932e-01  9.65301916e-02  3.89098674e-02 -6.07600659e-02
 -1.44319925e-02 -2.37527546e-02  1.40748173e-01  1.01559199e-02
 -2.96867881e-02  7.59637356e-02 -1.28639089e-02 -1.03617705e-01
  3.53865586e-02  2.58285999e-02 -2.47355364e-02  3.14401388e-02
 -8.02845955e-02  2.78930962e-02 -2.51635928e-02  6.00934848e-02
  1.41579017e-01 -6.83199689e-02  5.87898865e-03 -1.83313601e-02
  4.06124964e-02 -6.60633519e-02 -1.19244955e-01  1.94623861e-02
 -6.28705993e-02 -4.04478423e-03 -7.40317851e-02 -7.25492388e-02
 -8.11627042e-03 -8.26193243e-02  8.88345316e-02  1.16606131e-02
  9.47007462e-02 -5.83177619e-02 -1.45221679e-02  6.16157020e-04
 -6.31113127e-02 -2.50887964e-02  6.01872280e-02  1.59547906e-02
 -9.67522245e-03 -3.58564146e-02 -3.93492617e-02 -9.13486406e-02
 -2.90397182e-02  1.78669058e-02  3.34740318e-02 -8.36239941e-03
 -1.95192583e-02 -2.73503587e-02 -1.63460951e-02  7.58995244e-04
  1.23664429e-02 -3.73883285e-02  5.00804037e-02 -4.30539809e-02
 -2.83194818e-02 -8.58169198e-02  3.73673216e-02 -2.92865876e-02
  1.75534897e-02  7.48214424e-02  7.75343776e-02  3.09614297e-02
 -3.30737382e-02 -2.35913671e-03  6.85290694e-02  7.56176412e-02
  2.73576658e-02 -2.17721872e-02 -3.11366692e-02 -2.95001445e-08
 -1.00294635e-01 -5.97752025e-03 -1.45322438e-02  4.12067724e-03
 -4.15112302e-02  4.98973019e-02 -4.00561839e-02 -9.23530012e-02
 -5.00793830e-02  6.81857765e-02  5.59744686e-02  3.74855697e-02
  7.26384744e-02  6.83505367e-03  6.03531711e-02 -3.61361839e-02
 -1.70280710e-02  6.65589795e-02 -4.19225059e-02 -3.05674858e-02
 -1.38555234e-03 -5.29974066e-02  7.51253143e-02 -1.14122778e-02
 -3.71169597e-02  4.89340920e-04 -2.31129415e-02  1.08276069e-01
  9.56613850e-03  2.30067596e-02  1.12477811e-02  5.65626211e-02
 -5.62738329e-02 -3.46402302e-02 -1.52198616e-02  6.62029255e-03
 -2.27477606e-02 -2.88072508e-02  3.93441990e-02  1.34451002e-01
 -7.62379766e-02  1.28213987e-02  3.41233499e-02  6.04857877e-02
 -1.56266347e-03  1.20424759e-02  2.62812283e-02 -8.15650821e-02
  9.83375907e-02  3.58882919e-02 -3.18557471e-02 -2.28076037e-02
  1.51444301e-02 -2.02483051e-02  4.78964578e-03  6.85615316e-02
 -2.05330160e-02 -2.06888318e-02 -1.37732625e-01  7.76482448e-02
  1.16653182e-02 -4.74089794e-02 -8.70513692e-02  5.17047793e-02]
After quantization: 
 [24549 27457  1005 14098   737 41255 30713 37284 16232 49667 65536 26496
 28123 37017 54476 61162 18040 59102 30213 34602 20160 32875 65536 43188
 11182 14118 61783     0 15310     0 25695 28492     0 57409     0 57083
 64280 15828 18345 51462     0     0 50060 18959 27644 24258 49981     0
 65536 36255 33578 16424 51002 33427 27750     0 50602 11585 18414 40947
 65536 45680 20290 51010  5999  2297 24786 35550 30811 19777 40488 30859
  9118 44750 55087  6571 65536 59520 54764 41422 10380 49410 54043  6903
 43100 44055 13241 59802 10559 18702 37935 55969     0 26838     0 54020
 19209 53512     0 65536     0 65536 65536 53708     0     0 59348 21732
 62349 27340 49744     0     0 35002 40343 65536 44616 10742     0     0
 26205 41346 65536 50342 21777     0     0 32769 62004 48541 63929 52403
 61126 27279 37560 52137 46505 38004 20492 18040 65536 22262 45786     0
  8262  4860 20246 28159 65536 52692 45495  9176  6436 65536 65536 45507
 65536 48358 15603  4868  3659     0 65536  3648 24991 43753 36397 41376
 46938 18269 65536 33898 10834 63441 65536 26912 21445 14415     0 61027
 30965 14631 61115 14118 65536 20204  3019 28010 10974 64941 12207 60795
     0     0 45013     0 65536 13476     0 51639     0 28066 20441 44252
 15782 33543 29019  2953 44396 21492 58315 57986     0 24412 27024     0
 18748 62797 19035 45474 62120 51990 55852 32768 51280 33720     0 24050
 65536 41385 37367 65536 23638  7203 65536 25603 29627 29728 65536 51601
 36758 36945  7563 31567 65536 65536 54110     0 24853 19741 65536 38339
 16486 65536 25713     0 52177 46935 19202 50013     0 48067 18967 65536
 65536     0 35993 22714 55044     0     0 43443     0 30550     0     0
 28317     0 65536 39164 65536   782 24803 33106     0 19008 65536 41519
 27462 13102 11186     0 16841 42568 51128 28182 22063 17767 23803 33185
 39551 12262 60237  9154 17236     0 53264 16705 42396 65536 65536 49750
 14628 31475 65536 65536 47774 20827 15691 32768     0 29490 24798 35029
 10000 60136 10798     0  5301 65536 63469 53329 65536 36517 65536 12949
 23429 65536  9775 16003 32009  3700 65536 26509 12411 33037 20092 65536
 38015 45387 38938 63792  1903 13769 24421 36400 20292 16968 54348 65536
     0 39801 51484 65536 31911 39374 47183     0 65536 52453 15296 20259
 41075 21663 35396 65536 21507 21421     0 65536 39167  6766     0 61128]
i = 0	fp32 square sum: 1.0000003576278687	int16 square sum: 0.6227178323200436
i = 1	fp32 square sum: 0.9999998211860657	int16 square sum: 0.6166294543249335
i = 2	fp32 square sum: 0.9999995231628418	int16 square sum: 0.6143139783417524
i = 3	fp32 square sum: 1.0000001192092896	int16 square sum: 0.6246966348785725
i = 4	fp32 square sum: 1.0000003576278687	int16 square sum: 0.6327804107017398
i = 5	fp32 square sum: 1.000000238418579	int16 square sum: 0.6098930142173244
i = 6	fp32 square sum: 1.0000001192092896	int16 square sum: 0.6380693130210159
i = 7	fp32 square sum: 0.9999995231628418	int16 square sum: 0.6019622719651232
i = 8	fp32 square sum: 1.0000001192092896	int16 square sum: 0.6146809683905758
i = 9	fp32 square sum: 0.9999998211860657	int16 square sum: 0.6486918431261848
Building...
add 0:100000, 0.112 s add 100000:200000, 0.219 s add 200000:300000, 0.406 s add 300000:400000, 0.684 s add 400000:500000, 0.796 s Searching...
R@1 = 0.7490
R@10 = 0.9630
R@100 = 0.9920
Experiment int20... scale factor = 0.3176809847354889
Before quantization: 
 [-1.49867618e-02 -9.68345348e-03 -5.79111241e-02 -3.40401605e-02
 -5.84010631e-02  1.54728433e-02 -3.74758942e-03  8.23296420e-03
 -3.01494971e-02  3.08102649e-02  1.13890767e-01 -1.14366421e-02
 -8.46892875e-03  7.74566829e-03  3.95780094e-02  5.17672338e-02
 -2.68540829e-02  4.80111353e-02 -4.65955725e-03  3.34247504e-03
 -2.29886174e-02  1.94406020e-04  6.12896234e-02  1.89975984e-02
 -3.93570587e-02 -3.40035483e-02  5.29002696e-02 -6.73171431e-02
 -3.18305343e-02 -6.47372678e-02 -1.28957117e-02 -7.79697532e-03
 -6.84998110e-02  4.49257270e-02 -6.86620697e-02  4.43314910e-02
  5.74522875e-02 -3.08865830e-02 -2.62973495e-02  3.40816341e-02
 -6.78526089e-02 -6.41803890e-02  3.15261297e-02 -2.51773596e-02
 -9.34352726e-03 -1.55171724e-02  3.13819274e-02 -7.63133019e-02
  6.93198517e-02  6.35677762e-03  1.47650717e-03 -2.98002828e-02
  3.32436226e-02  1.20005116e-03 -9.14921984e-03 -6.41457438e-02
  3.25135961e-02 -3.86229344e-02 -2.61718389e-02  1.49117317e-02
  7.21704364e-02  2.35404242e-02 -2.27502938e-02  3.32574919e-02
 -4.88067493e-02 -5.55564277e-02 -1.45545555e-02  5.07149147e-03
 -3.56880506e-03 -2.36863233e-02  1.40741933e-02 -3.48075340e-03
 -4.31204736e-02  2.18455698e-02  4.06909883e-02 -4.77637202e-02
  8.16162080e-02  4.87731695e-02  4.01032642e-02  1.57765877e-02
 -4.08191793e-02  3.03414892e-02  3.87875251e-02 -4.71578874e-02
  1.88364442e-02  2.05781907e-02 -3.56025845e-02  4.92872447e-02
 -4.04932089e-02 -2.56460179e-02  9.42029618e-03  4.22992446e-02
 -1.11963868e-01 -1.08125117e-02 -6.35822639e-02  3.87455001e-02
 -2.47221589e-02  3.78200226e-02 -6.44943863e-02  6.30875379e-02
 -7.12282583e-02  7.53201842e-02  8.37952569e-02  3.81772481e-02
 -6.15315251e-02 -8.99483860e-02  4.84602414e-02 -2.01212522e-02
  5.39325178e-02 -9.89652332e-03  3.09501532e-02 -8.99807066e-02
 -6.74129277e-02  4.07188386e-03  1.38107147e-02  6.58543482e-02
  2.16003526e-02 -4.01584692e-02 -9.61588919e-02 -6.52997345e-02
 -1.19673759e-02  1.56386346e-02  7.09095821e-02  3.20403911e-02
 -2.00403128e-02 -6.43938407e-02 -9.91705731e-02  2.62832570e-34
  5.33027761e-02  2.87559871e-02  5.68117984e-02  3.57985310e-02
  5.17026037e-02 -1.00081079e-02  8.73631053e-03  3.53132039e-02
  2.50439458e-02  9.54495557e-03 -2.23834850e-02 -2.68531516e-02
  6.06561787e-02 -1.91564728e-02  2.37346515e-02 -7.54912421e-02
 -4.46815826e-02 -5.08830957e-02 -2.28309687e-02 -8.40491522e-03
  9.68801826e-02  3.63240428e-02  2.32038852e-02 -4.30141464e-02
 -4.80103493e-02  7.30274841e-02  1.53448552e-01  2.32242756e-02
  1.04601488e-01  2.84230933e-02 -3.12963352e-02 -5.08695543e-02
 -5.30726090e-02 -9.35416222e-02  1.08407155e-01 -5.30931279e-02
 -1.41807878e-02  2.00267918e-02  6.61519729e-03  1.56937242e-02
  2.58342959e-02 -2.64351722e-02  8.31351876e-02  2.05967063e-03
 -3.99919711e-02  5.59228621e-02  1.51585996e-01 -1.06778312e-02
 -2.06448305e-02 -3.34620029e-02 -1.24203831e-01  5.15222922e-02
 -3.28843878e-03 -3.30695100e-02  5.16825318e-02 -3.40045244e-02
  6.23184480e-02 -2.29074862e-02 -5.42399734e-02 -8.67629796e-03
 -3.97358090e-02  5.86575903e-02 -3.74881066e-02  5.10992892e-02
 -6.59760162e-02 -7.75630474e-02  2.23245677e-02 -8.87607560e-02
  9.07822847e-02 -3.51750888e-02 -7.51072094e-02  3.44051160e-02
 -6.14057630e-02 -8.57327692e-03 -2.24762894e-02  2.09367536e-02
 -3.09693497e-02  1.41246675e-03 -6.83588721e-03 -5.43593615e-02
  2.11986210e-02 -2.05597077e-02  4.65770438e-02  4.59764935e-02
 -6.99426904e-02 -1.52349640e-02 -1.04732588e-02 -7.49177486e-02
 -2.55625006e-02  5.47486879e-02 -2.50392798e-02  2.31649559e-02
  5.35149723e-02  3.50459442e-02  4.20869142e-02 -2.63932130e-33
  3.37502584e-02  1.73416326e-03 -6.24770448e-02 -1.58950407e-02
  1.22457102e-01  1.57097261e-02  8.38483963e-03  6.33168370e-02
 -1.66476108e-02 -4.66118678e-02  7.96821415e-02 -1.30651994e-02
 -5.72722498e-03 -5.54403523e-03  1.23275213e-01  3.43351103e-02
  7.27453455e-03  7.61426380e-03 -4.59552035e-02 -2.19059619e-03
  1.11198932e-01  9.65301916e-02  3.89098674e-02 -6.07600659e-02
 -1.44319925e-02 -2.37527546e-02  1.40748173e-01  1.01559199e-02
 -2.96867881e-02  7.59637356e-02 -1.28639089e-02 -1.03617705e-01
  3.53865586e-02  2.58285999e-02 -2.47355364e-02  3.14401388e-02
 -8.02845955e-02  2.78930962e-02 -2.51635928e-02  6.00934848e-02
  1.41579017e-01 -6.83199689e-02  5.87898865e-03 -1.83313601e-02
  4.06124964e-02 -6.60633519e-02 -1.19244955e-01  1.94623861e-02
 -6.28705993e-02 -4.04478423e-03 -7.40317851e-02 -7.25492388e-02
 -8.11627042e-03 -8.26193243e-02  8.88345316e-02  1.16606131e-02
  9.47007462e-02 -5.83177619e-02 -1.45221679e-02  6.16157020e-04
 -6.31113127e-02 -2.50887964e-02  6.01872280e-02  1.59547906e-02
 -9.67522245e-03 -3.58564146e-02 -3.93492617e-02 -9.13486406e-02
 -2.90397182e-02  1.78669058e-02  3.34740318e-02 -8.36239941e-03
 -1.95192583e-02 -2.73503587e-02 -1.63460951e-02  7.58995244e-04
  1.23664429e-02 -3.73883285e-02  5.00804037e-02 -4.30539809e-02
 -2.83194818e-02 -8.58169198e-02  3.73673216e-02 -2.92865876e-02
  1.75534897e-02  7.48214424e-02  7.75343776e-02  3.09614297e-02
 -3.30737382e-02 -2.35913671e-03  6.85290694e-02  7.56176412e-02
  2.73576658e-02 -2.17721872e-02 -3.11366692e-02 -2.95001445e-08
 -1.00294635e-01 -5.97752025e-03 -1.45322438e-02  4.12067724e-03
 -4.15112302e-02  4.98973019e-02 -4.00561839e-02 -9.23530012e-02
 -5.00793830e-02  6.81857765e-02  5.59744686e-02  3.74855697e-02
  7.26384744e-02  6.83505367e-03  6.03531711e-02 -3.61361839e-02
 -1.70280710e-02  6.65589795e-02 -4.19225059e-02 -3.05674858e-02
 -1.38555234e-03 -5.29974066e-02  7.51253143e-02 -1.14122778e-02
 -3.71169597e-02  4.89340920e-04 -2.31129415e-02  1.08276069e-01
  9.56613850e-03  2.30067596e-02  1.12477811e-02  5.65626211e-02
 -5.62738329e-02 -3.46402302e-02 -1.52198616e-02  6.62029255e-03
 -2.27477606e-02 -2.88072508e-02  3.93441990e-02  1.34451002e-01
 -7.62379766e-02  1.28213987e-02  3.41233499e-02  6.04857877e-02
 -1.56266347e-03  1.20424759e-02  2.62812283e-02 -8.15650821e-02
  9.83375907e-02  3.58882919e-02 -3.18557471e-02 -2.28076037e-02
  1.51444301e-02 -2.02483051e-02  4.78964578e-03  6.85615316e-02
 -2.05330160e-02 -2.06888318e-02 -1.37732625e-01  7.76482448e-02
  1.16653182e-02 -4.74089794e-02 -8.70513692e-02  5.17047793e-02]
After quantization: 
 [ 474821  492326  333140  411931  331523  575360  511919  551463  424773
  625985  900210  486539  496335  549855  654924  695158  435651  682760
  508909  535321  448410  524930  726588  586994  394382  412052  698897
  302093  419225  310609  481723  498553  298190  672576  297654  670614
  713922  422341  437488  636782  300326  312447  628347  441185  493448
  473071  627871  272400  753094  545270  529162  425926  634016  528250
  494089  312561  631607  396805  437903  573508  762503  601989  449196
  634062  363191  340912  476248  541028  512509  446107  570743  512800
  381960  596395  658598  366634  793681  685275  656658  576363  389556
  624437  652315  368634  586462  592211  406774  686972  390632  439638
  555382  663906  154727  488599  314421  652177  442688  649122  311411
  732523  289184  772899  800873  650301  321190  227394  684242  457874
  702305  491623  626446  227287  301777  537729  569874  741655  595585
  391737  206895  308752  484788  575907  758341  630045  458141  311742
  196954  524289  700226  619204  711808  642449  694944  491255  553125
  640848  606952  555794  450407  435654  724498  461058  602630  275113
  376807  356338  448930  496546  844063  644184  600878  382311  365820
  765332 1030779  600945  869549  618105  420988  356382  349111  215534
  882110  349043  477482  590391  546123  576089  609560  437033  798694
  531087  392286  708874 1024631  489044  456146  413840  114326  694349
  513434  415135  694878  412049  729984  448677  345258  495650  393132
  717901  400551  692953  306520  268275  597976  231314  823935  408185
  276381  637850  321605  495991  450101  593395  422067  528951  501725
  344863  594259  456427  678026  676044  293427  474002  489719  277006
  439914  704999  441641  600750  700926  639965  663206  524288  635689
  530012  318069  471823  928485  576142  551965  733280  469339  370436
  787297  481164  505385  505989  931185  637619  548300  549421  372603
  517058  891325  842908  652719  323737  476653  445887  988859  557810
  426301  775024  481828  182275  641090  609541  442643  628064  259292
  616356  441231  722640  991601  298783  543693  463782  658339  306232
  130694  588528  316770  510938  279930  284824  497499  251585  817506
  562777  836869  331798  476355  526322  315976  441477  722950  576951
  492353  405937  394408  222772  428437  583262  634777  496687  459861
  434013  470335  526794  565107  400880  689590  382179  430814  241031
  647628  427622  582228  771253  780208  626484  415121  516502  750484
  773881  614588  452425  421515  524288  193244  504558  476322  537890
  387272  688986  392074  219457  358990  749351  709045  648018  764048
  546849  723497  405013  468084  743981  385914  423394  519715  349359
  772256  486620  401776  525904  447999  881677  555864  600227  561414
  710986  338544  409951  474052  546140  449205  429204  654153  968074
  272648  566608  636920  723935  519131  564037  611035  255065  848873
  642746  419142  449007  574276  457455  540098  750591  456515  456000
   69672  780584  562792  367805  236956  694952]
i = 0	fp32 square sum: 1.0000003576278687	int20 square sum: 1.0000002296283177
i = 1	fp32 square sum: 0.9999998211860657	int20 square sum: 0.9999996400326623
i = 2	fp32 square sum: 0.9999995231628418	int20 square sum: 0.9999996033283878
i = 3	fp32 square sum: 1.0000001192092896	int20 square sum: 0.9873935273815312
i = 4	fp32 square sum: 1.0000003576278687	int20 square sum: 0.9996823507916376
i = 5	fp32 square sum: 1.000000238418579	int20 square sum: 1.0000003211174049
i = 6	fp32 square sum: 1.0000001192092896	int20 square sum: 1.0000002965883494
i = 7	fp32 square sum: 0.9999995231628418	int20 square sum: 0.9999996525675954
i = 8	fp32 square sum: 1.0000001192092896	int20 square sum: 0.9888661685907661
i = 9	fp32 square sum: 0.9999998211860657	int20 square sum: 1.000000286821813
Building...
add 0:100000, 0.113 s add 100000:200000, 0.218 s add 200000:300000, 0.409 s add 300000:400000, 0.690 s add 400000:500000, 0.799 s Searching...
R@1 = 0.9410
R@10 = 0.9830
R@100 = 0.9950
Experiment int20... scale factor = 0.11948662996292114
Before quantization: 
 [-1.49867618e-02 -9.68345348e-03 -5.79111241e-02 -3.40401605e-02
 -5.84010631e-02  1.54728433e-02 -3.74758942e-03  8.23296420e-03
 -3.01494971e-02  3.08102649e-02  1.13890767e-01 -1.14366421e-02
 -8.46892875e-03  7.74566829e-03  3.95780094e-02  5.17672338e-02
 -2.68540829e-02  4.80111353e-02 -4.65955725e-03  3.34247504e-03
 -2.29886174e-02  1.94406020e-04  6.12896234e-02  1.89975984e-02
 -3.93570587e-02 -3.40035483e-02  5.29002696e-02 -6.73171431e-02
 -3.18305343e-02 -6.47372678e-02 -1.28957117e-02 -7.79697532e-03
 -6.84998110e-02  4.49257270e-02 -6.86620697e-02  4.43314910e-02
  5.74522875e-02 -3.08865830e-02 -2.62973495e-02  3.40816341e-02
 -6.78526089e-02 -6.41803890e-02  3.15261297e-02 -2.51773596e-02
 -9.34352726e-03 -1.55171724e-02  3.13819274e-02 -7.63133019e-02
  6.93198517e-02  6.35677762e-03  1.47650717e-03 -2.98002828e-02
  3.32436226e-02  1.20005116e-03 -9.14921984e-03 -6.41457438e-02
  3.25135961e-02 -3.86229344e-02 -2.61718389e-02  1.49117317e-02
  7.21704364e-02  2.35404242e-02 -2.27502938e-02  3.32574919e-02
 -4.88067493e-02 -5.55564277e-02 -1.45545555e-02  5.07149147e-03
 -3.56880506e-03 -2.36863233e-02  1.40741933e-02 -3.48075340e-03
 -4.31204736e-02  2.18455698e-02  4.06909883e-02 -4.77637202e-02
  8.16162080e-02  4.87731695e-02  4.01032642e-02  1.57765877e-02
 -4.08191793e-02  3.03414892e-02  3.87875251e-02 -4.71578874e-02
  1.88364442e-02  2.05781907e-02 -3.56025845e-02  4.92872447e-02
 -4.04932089e-02 -2.56460179e-02  9.42029618e-03  4.22992446e-02
 -1.11963868e-01 -1.08125117e-02 -6.35822639e-02  3.87455001e-02
 -2.47221589e-02  3.78200226e-02 -6.44943863e-02  6.30875379e-02
 -7.12282583e-02  7.53201842e-02  8.37952569e-02  3.81772481e-02
 -6.15315251e-02 -8.99483860e-02  4.84602414e-02 -2.01212522e-02
  5.39325178e-02 -9.89652332e-03  3.09501532e-02 -8.99807066e-02
 -6.74129277e-02  4.07188386e-03  1.38107147e-02  6.58543482e-02
  2.16003526e-02 -4.01584692e-02 -9.61588919e-02 -6.52997345e-02
 -1.19673759e-02  1.56386346e-02  7.09095821e-02  3.20403911e-02
 -2.00403128e-02 -6.43938407e-02 -9.91705731e-02  2.62832570e-34
  5.33027761e-02  2.87559871e-02  5.68117984e-02  3.57985310e-02
  5.17026037e-02 -1.00081079e-02  8.73631053e-03  3.53132039e-02
  2.50439458e-02  9.54495557e-03 -2.23834850e-02 -2.68531516e-02
  6.06561787e-02 -1.91564728e-02  2.37346515e-02 -7.54912421e-02
 -4.46815826e-02 -5.08830957e-02 -2.28309687e-02 -8.40491522e-03
  9.68801826e-02  3.63240428e-02  2.32038852e-02 -4.30141464e-02
 -4.80103493e-02  7.30274841e-02  1.53448552e-01  2.32242756e-02
  1.04601488e-01  2.84230933e-02 -3.12963352e-02 -5.08695543e-02
 -5.30726090e-02 -9.35416222e-02  1.08407155e-01 -5.30931279e-02
 -1.41807878e-02  2.00267918e-02  6.61519729e-03  1.56937242e-02
  2.58342959e-02 -2.64351722e-02  8.31351876e-02  2.05967063e-03
 -3.99919711e-02  5.59228621e-02  1.51585996e-01 -1.06778312e-02
 -2.06448305e-02 -3.34620029e-02 -1.24203831e-01  5.15222922e-02
 -3.28843878e-03 -3.30695100e-02  5.16825318e-02 -3.40045244e-02
  6.23184480e-02 -2.29074862e-02 -5.42399734e-02 -8.67629796e-03
 -3.97358090e-02  5.86575903e-02 -3.74881066e-02  5.10992892e-02
 -6.59760162e-02 -7.75630474e-02  2.23245677e-02 -8.87607560e-02
  9.07822847e-02 -3.51750888e-02 -7.51072094e-02  3.44051160e-02
 -6.14057630e-02 -8.57327692e-03 -2.24762894e-02  2.09367536e-02
 -3.09693497e-02  1.41246675e-03 -6.83588721e-03 -5.43593615e-02
  2.11986210e-02 -2.05597077e-02  4.65770438e-02  4.59764935e-02
 -6.99426904e-02 -1.52349640e-02 -1.04732588e-02 -7.49177486e-02
 -2.55625006e-02  5.47486879e-02 -2.50392798e-02  2.31649559e-02
  5.35149723e-02  3.50459442e-02  4.20869142e-02 -2.63932130e-33
  3.37502584e-02  1.73416326e-03 -6.24770448e-02 -1.58950407e-02
  1.22457102e-01  1.57097261e-02  8.38483963e-03  6.33168370e-02
 -1.66476108e-02 -4.66118678e-02  7.96821415e-02 -1.30651994e-02
 -5.72722498e-03 -5.54403523e-03  1.23275213e-01  3.43351103e-02
  7.27453455e-03  7.61426380e-03 -4.59552035e-02 -2.19059619e-03
  1.11198932e-01  9.65301916e-02  3.89098674e-02 -6.07600659e-02
 -1.44319925e-02 -2.37527546e-02  1.40748173e-01  1.01559199e-02
 -2.96867881e-02  7.59637356e-02 -1.28639089e-02 -1.03617705e-01
  3.53865586e-02  2.58285999e-02 -2.47355364e-02  3.14401388e-02
 -8.02845955e-02  2.78930962e-02 -2.51635928e-02  6.00934848e-02
  1.41579017e-01 -6.83199689e-02  5.87898865e-03 -1.83313601e-02
  4.06124964e-02 -6.60633519e-02 -1.19244955e-01  1.94623861e-02
 -6.28705993e-02 -4.04478423e-03 -7.40317851e-02 -7.25492388e-02
 -8.11627042e-03 -8.26193243e-02  8.88345316e-02  1.16606131e-02
  9.47007462e-02 -5.83177619e-02 -1.45221679e-02  6.16157020e-04
 -6.31113127e-02 -2.50887964e-02  6.01872280e-02  1.59547906e-02
 -9.67522245e-03 -3.58564146e-02 -3.93492617e-02 -9.13486406e-02
 -2.90397182e-02  1.78669058e-02  3.34740318e-02 -8.36239941e-03
 -1.95192583e-02 -2.73503587e-02 -1.63460951e-02  7.58995244e-04
  1.23664429e-02 -3.73883285e-02  5.00804037e-02 -4.30539809e-02
 -2.83194818e-02 -8.58169198e-02  3.73673216e-02 -2.92865876e-02
  1.75534897e-02  7.48214424e-02  7.75343776e-02  3.09614297e-02
 -3.30737382e-02 -2.35913671e-03  6.85290694e-02  7.56176412e-02
  2.73576658e-02 -2.17721872e-02 -3.11366692e-02 -2.95001445e-08
 -1.00294635e-01 -5.97752025e-03 -1.45322438e-02  4.12067724e-03
 -4.15112302e-02  4.98973019e-02 -4.00561839e-02 -9.23530012e-02
 -5.00793830e-02  6.81857765e-02  5.59744686e-02  3.74855697e-02
  7.26384744e-02  6.83505367e-03  6.03531711e-02 -3.61361839e-02
 -1.70280710e-02  6.65589795e-02 -4.19225059e-02 -3.05674858e-02
 -1.38555234e-03 -5.29974066e-02  7.51253143e-02 -1.14122778e-02
 -3.71169597e-02  4.89340920e-04 -2.31129415e-02  1.08276069e-01
  9.56613850e-03  2.30067596e-02  1.12477811e-02  5.65626211e-02
 -5.62738329e-02 -3.46402302e-02 -1.52198616e-02  6.62029255e-03
 -2.27477606e-02 -2.88072508e-02  3.93441990e-02  1.34451002e-01
 -7.62379766e-02  1.28213987e-02  3.41233499e-02  6.04857877e-02
 -1.56266347e-03  1.20424759e-02  2.62812283e-02 -8.15650821e-02
  9.83375907e-02  3.58882919e-02 -3.18557471e-02 -2.28076037e-02
  1.51444301e-02 -2.02483051e-02  4.78964578e-03  6.85615316e-02
 -2.05330160e-02 -2.06888318e-02 -1.37732625e-01  7.76482448e-02
  1.16653182e-02 -4.74089794e-02 -8.70513692e-02  5.17047793e-02]
After quantization: 
 [ 392770  439310   16079  225563   11780  660073  491401  596538  259706
  794669 1048576  423924  449968  592262  871612  978581  288626  945619
  483398  553621  322548  525995 1048576  691005  178904  225884  988524
       0  244954       0  411120  455865       0  918542       0  913327
 1028471  253238  293511  823378       0       0  800952  303340  442293
  388115  799686       0 1048576  580074  537246  262771  816024  534820
  443998       0  809617  185346  294613  655149 1048576  730872  324639
  816145   95976   36743  396562  568794  492970  316425  647799  493743
  145877  715998  881379  105130 1048576  952306  876222  662739  166073
  790556  864675  110446  689591  704876  211852  956817  168933  299227
  606958  895493       0  429401       0  864306  307335  856185       0
 1048576       0 1048576 1048576  859320       0       0  949560  347711
  997583  437440  795897       0       0  560022  645487 1048576  713846
  171871       0       0  419267  661528 1048576  805465  348421       0
       0  524289  992056  776642 1022850  838445  978014  436461  600956
  834186  744066  608052  327858  288634 1048576  356177  732576       0
  132177   77755  323931  450530 1048576  843057  727918  146810  102965
 1048576 1048576  728097 1048576  773720  249642   77874   58540       0
 1048576   58360  399842  700037  582341  662012  751002  292302 1048576
  542364  173332 1015049 1048576  430583  343116  230637       0  976431
  495430  234081  977838  225876 1048576  323260   48296  448148  175580
 1039049  195305  972719       0       0  720202       0 1048576  215603
       0  826217       0  449052  327044  708023  252512  536684  464299
   47248  710321  343863  933034  927763       0  390591  432379       0
  299960 1004745  304552  727577  993919  831840  893630  524288  820470
  539507       0  384799 1048576  662152  597871 1048576  378194  115238
 1048576  409633  474028  475636 1048576  825602  588127  591109  121001
  505065 1048576 1048576  865749       0  397638  315842 1048576  613414
  263767 1048576  411399       0  834829  750952  307217  800197       0
  769069  303461 1048576 1048576       0  575881  363418  880691       0
       0  695084       0  488793       0       0  453063       0 1048576
  626618 1048576   12511  396847  529696       0  304117 1048576  664303
  439382  209624  178972       0  269445  681083  818046  450903  352994
  284271  380840  530949  632812  196181  963778  146461  275766       0
  852212  267279  678332 1048576 1048576  795996  234044  503585 1048576
 1048576  764371  333223  251043  524288       0  471832  396758  560450
  159999  962171  172768       0   84808 1048576 1015502  853250 1048576
  584271 1048576  207169  374856 1048576  156390  256038  512129   59200
 1048576  424138  198562  528583  321457 1048576  608238  726188  622995
 1020664   30448  220297  390724  582386  324662  271485  869560 1048576
       0  636805  823744 1048576  510575  629969  754924       0 1048576
  839233  244733  324136  657191  346596  566321 1048576  344097  342730
       0 1048576  626660  108243       0  978033]
i = 0	fp32 square sum: 1.0000003576278687	int20 square sum: 0.6227180958314467
i = 1	fp32 square sum: 0.9999998211860657	int20 square sum: 0.6166302789314444
i = 2	fp32 square sum: 0.9999995231628418	int20 square sum: 0.6143127473951483
i = 3	fp32 square sum: 1.0000001192092896	int20 square sum: 0.624698262775508
i = 4	fp32 square sum: 1.0000003576278687	int20 square sum: 0.6327805043196633
i = 5	fp32 square sum: 1.000000238418579	int20 square sum: 0.6098919682153937
i = 6	fp32 square sum: 1.0000001192092896	int20 square sum: 0.6380678285186918
i = 7	fp32 square sum: 0.9999995231628418	int20 square sum: 0.6019625815186773
i = 8	fp32 square sum: 1.0000001192092896	int20 square sum: 0.6146826114300148
i = 9	fp32 square sum: 0.9999998211860657	int20 square sum: 0.6486924188289218
Building...
add 0:100000, 0.111 s add 100000:200000, 0.217 s add 200000:300000, 0.405 s add 300000:400000, 0.681 s add 400000:500000, 0.790 s Searching...
R@1 = 0.7510
R@10 = 0.9710
R@100 = 0.9970
